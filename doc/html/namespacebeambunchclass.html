<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IMPACT Z: beambunchclass Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IMPACT Z
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">beambunchclass Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class defines the charged particle beam bunch information in the accelerator.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:structbeambunchclass_1_1beambunch"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a></td></tr>
<tr class="separator:structbeambunchclass_1_1beambunch"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacebeambunchclass_1_1map1__beambunch.html">map1_beambunch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacebeambunchclass_1_1map2__beambunch.html">map2_beambunch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1605e527eb41043dc5962da1e3bb5159"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a1605e527eb41043dc5962da1e3bb5159">construct_beambunch</a> (this, incurr, inkin, inmass, incharge</td></tr>
<tr class="separator:a1605e527eb41043dc5962da1e3bb5159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea8cfefa2f70ade95202cc40f015f7bf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aea8cfefa2f70ade95202cc40f015f7bf">geomerrl_beambunch</a> (this, beamln)</td></tr>
<tr class="memdesc:aea8cfefa2f70ade95202cc40f015f7bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">shift and rotate the beam at the leading edge of the element  <a href="#aea8cfefa2f70ade95202cc40f015f7bf">More...</a><br /></td></tr>
<tr class="separator:aea8cfefa2f70ade95202cc40f015f7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f6f9e95d5786dab15c1b73f305e349"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ab2f6f9e95d5786dab15c1b73f305e349">geomerrt_beambunch</a> (this, beamln)</td></tr>
<tr class="memdesc:ab2f6f9e95d5786dab15c1b73f305e349"><td class="mdescLeft">&#160;</td><td class="mdescRight">shift and rotate the beam at the tail edge of the element  <a href="#ab2f6f9e95d5786dab15c1b73f305e349">More...</a><br /></td></tr>
<tr class="separator:ab2f6f9e95d5786dab15c1b73f305e349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be2b49f0fef567493258758c44fffd6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3be2b49f0fef567493258758c44fffd6">drift1org_beambunch</a> (this, beamln, z, tau)</td></tr>
<tr class="memdesc:a3be2b49f0fef567493258758c44fffd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift beam half step using linear map for external field.  <a href="#a3be2b49f0fef567493258758c44fffd6">More...</a><br /></td></tr>
<tr class="separator:a3be2b49f0fef567493258758c44fffd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212c0d38a812d95f238d7da7f29ac17c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a212c0d38a812d95f238d7da7f29ac17c">drift1_beambunch</a> (this, beamln, z, tau, bitype, nseg, nst, ih</td></tr>
<tr class="memdesc:a212c0d38a812d95f238d7da7f29ac17c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift beam half step using linear map for external field.  <a href="#a212c0d38a812d95f238d7da7f29ac17c">More...</a><br /></td></tr>
<tr class="separator:a212c0d38a812d95f238d7da7f29ac17c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e3aecf1a2cf3d54950c09c603c2f11c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a6e3aecf1a2cf3d54950c09c603c2f11c">drift2_beambunch</a> (this, z, tau)</td></tr>
<tr class="memdesc:a6e3aecf1a2cf3d54950c09c603c2f11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">drift half step using nonlinear Lorentz integrator  <a href="#a6e3aecf1a2cf3d54950c09c603c2f11c">More...</a><br /></td></tr>
<tr class="separator:a6e3aecf1a2cf3d54950c09c603c2f11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5a86fb4b3ff5b33efdfa76b1c52ce4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3f5a86fb4b3ff5b33efdfa76b1c52ce4">drift2halo_beambunch</a> (this, z, tau)</td></tr>
<tr class="memdesc:a3f5a86fb4b3ff5b33efdfa76b1c52ce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">drift half step using nonlinear Lorentz integrator for halo study  <a href="#a3f5a86fb4b3ff5b33efdfa76b1c52ce4">More...</a><br /></td></tr>
<tr class="separator:a3f5a86fb4b3ff5b33efdfa76b1c52ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618f97b46c83d8ca29a7cb05345d655e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a618f97b46c83d8ca29a7cb05345d655e">lostcount_beambunch</a> (this, nplc, nptot, xrad, yrad)</td></tr>
<tr class="memdesc:a618f97b46c83d8ca29a7cb05345d655e"><td class="mdescLeft">&#160;</td><td class="mdescRight">counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket yet.  <a href="#a618f97b46c83d8ca29a7cb05345d655e">More...</a><br /></td></tr>
<tr class="separator:a618f97b46c83d8ca29a7cb05345d655e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a4d80405bb8fbde341ea9e46a224e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a54a4d80405bb8fbde341ea9e46a224e4">lostcountxy_beambunch</a> (this, nplc, nptot, x1, x2, y1, y2)</td></tr>
<tr class="memdesc:a54a4d80405bb8fbde341ea9e46a224e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket yet.  <a href="#a54a4d80405bb8fbde341ea9e46a224e4">More...</a><br /></td></tr>
<tr class="separator:a54a4d80405bb8fbde341ea9e46a224e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b1c15c02703f7339b67283bc9816bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ac5b1c15c02703f7339b67283bc9816bd">chgupdate_beambunch</a> (this, nchge, idchgold, qmcclist)</td></tr>
<tr class="memdesc:ac5b1c15c02703f7339b67283bc9816bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">update the total current fraction of each charge state update total # of ptcl for each charge state  <a href="#ac5b1c15c02703f7339b67283bc9816bd">More...</a><br /></td></tr>
<tr class="separator:ac5b1c15c02703f7339b67283bc9816bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a030c80c97cd3523478e56fdaff0e7560"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a030c80c97cd3523478e56fdaff0e7560">convforth0th_beambunch</a> (this)</td></tr>
<tr class="memdesc:a030c80c97cd3523478e56fdaff0e7560"><td class="mdescLeft">&#160;</td><td class="mdescRight">0th order algorithm to transfer from z to t frame.  <a href="#a030c80c97cd3523478e56fdaff0e7560">More...</a><br /></td></tr>
<tr class="separator:a030c80c97cd3523478e56fdaff0e7560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35f6511340579ba6bb5f07bebf6d09d5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a35f6511340579ba6bb5f07bebf6d09d5">convforth1st_beambunch</a> (this)</td></tr>
<tr class="memdesc:a35f6511340579ba6bb5f07bebf6d09d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear(1st order) algorithm to transfer from z to t frame.  <a href="#a35f6511340579ba6bb5f07bebf6d09d5">More...</a><br /></td></tr>
<tr class="separator:a35f6511340579ba6bb5f07bebf6d09d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12625a90fb4a096ff15ba55f655b148"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ad12625a90fb4a096ff15ba55f655b148">convback0th_beambunch</a> (this)</td></tr>
<tr class="memdesc:ad12625a90fb4a096ff15ba55f655b148"><td class="mdescLeft">&#160;</td><td class="mdescRight">0th order algorithm to transfer from t to z frame.  <a href="#ad12625a90fb4a096ff15ba55f655b148">More...</a><br /></td></tr>
<tr class="separator:ad12625a90fb4a096ff15ba55f655b148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704068cca17e98c6568c1e6056d1c4d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a704068cca17e98c6568c1e6056d1c4d6">convback1st_beambunch</a> (this)</td></tr>
<tr class="memdesc:a704068cca17e98c6568c1e6056d1c4d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear algorithm to transfer from t to z frame.  <a href="#a704068cca17e98c6568c1e6056d1c4d6">More...</a><br /></td></tr>
<tr class="separator:a704068cca17e98c6568c1e6056d1c4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374fdc0e530a8835113fcd674283a150"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a374fdc0e530a8835113fcd674283a150">conv0thold_beambunch</a> (this, tau, rad, nplc, nptot)</td></tr>
<tr class="memdesc:a374fdc0e530a8835113fcd674283a150"><td class="mdescLeft">&#160;</td><td class="mdescRight">from z to t beam frame 0th order approximation.  <a href="#a374fdc0e530a8835113fcd674283a150">More...</a><br /></td></tr>
<tr class="separator:a374fdc0e530a8835113fcd674283a150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad456951b863b3dfab6eb7fa018e17230"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ad456951b863b3dfab6eb7fa018e17230">conv0th_beambunch</a> (this, tau, nplc, nptot, ptrange, Flagbc, perd, xrad, yrad)</td></tr>
<tr class="memdesc:ad456951b863b3dfab6eb7fa018e17230"><td class="mdescLeft">&#160;</td><td class="mdescRight">from z to t beam frame 0th order transformation.  <a href="#ad456951b863b3dfab6eb7fa018e17230">More...</a><br /></td></tr>
<tr class="separator:ad456951b863b3dfab6eb7fa018e17230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b46fd8b4c41577688761ad62175772b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a0b46fd8b4c41577688761ad62175772b">conv1st_beambunch</a> (this, tau, nplc, nptot, ptrange, Flagbc, perd, xrad, yrad)</td></tr>
<tr class="memdesc:a0b46fd8b4c41577688761ad62175772b"><td class="mdescLeft">&#160;</td><td class="mdescRight">from z to t beam frame 1st order transformation.  <a href="#a0b46fd8b4c41577688761ad62175772b">More...</a><br /></td></tr>
<tr class="separator:a0b46fd8b4c41577688761ad62175772b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acacb775484bda2729c3da9adbbeffc53"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#acacb775484bda2729c3da9adbbeffc53">cvbkforth1st_beambunch</a> (this)</td></tr>
<tr class="separator:acacb775484bda2729c3da9adbbeffc53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf23fdc1e8ca69fe7fe8f2995fbc1bcc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#abf23fdc1e8ca69fe7fe8f2995fbc1bcc">kick1_beambunch</a> (this, tau, innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, perdlen)</td></tr>
<tr class="memdesc:abf23fdc1e8ca69fe7fe8f2995fbc1bcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, all indices of potential are local to processor. Advance the particles in the velocity space using the force from the external field and the self space charge force interpolated from the grid to particles. (linear map)  <a href="#abf23fdc1e8ca69fe7fe8f2995fbc1bcc">More...</a><br /></td></tr>
<tr class="separator:abf23fdc1e8ca69fe7fe8f2995fbc1bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a023a12f9279f0764fc57deda1bcb852f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a023a12f9279f0764fc57deda1bcb852f">scatter1_beambunch</a> (innp, innx, inny, innz, rays, exg, eyg, ezg, ptsgeom, npx, npy, myidx, myidy, gam, curr, tau, mass</td></tr>
<tr class="memdesc:a023a12f9279f0764fc57deda1bcb852f"><td class="mdescLeft">&#160;</td><td class="mdescRight">scatter grid quantity onto particles using linear map.  <a href="#a023a12f9279f0764fc57deda1bcb852f">More...</a><br /></td></tr>
<tr class="separator:a023a12f9279f0764fc57deda1bcb852f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398a8735bfae34f0d7a9337c8e5ec621"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a398a8735bfae34f0d7a9337c8e5ec621">kick2_beambunch</a> (this, beamelem, z, tau, innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, flagerr)</td></tr>
<tr class="memdesc:a398a8735bfae34f0d7a9337c8e5ec621"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, all indices of potential are local to processor. Advance the particles in the velocity space using the force from the external field and the self space charge force interpolated from the grid to particles. (Lorentz force)  <a href="#a398a8735bfae34f0d7a9337c8e5ec621">More...</a><br /></td></tr>
<tr class="separator:a398a8735bfae34f0d7a9337c8e5ec621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2054e6e5714a86db0112c5eb3978abb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ad2054e6e5714a86db0112c5eb3978abb">scatter2_beambunch</a> (innp, innx, inny, innz, rays, exg, eyg, ezg, ptsgeom, npx, npy, myidx, myidy, tg, gam, curr, chge, mass, tau, z,</td></tr>
<tr class="separator:ad2054e6e5714a86db0112c5eb3978abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a96c99996275cf03ceec41dc011695e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a8a96c99996275cf03ceec41dc011695e">scatter20_beambunch</a> (innp, rays, tg, gam, chge, mass, tau, z, beamelem)</td></tr>
<tr class="memdesc:a8a96c99996275cf03ceec41dc011695e"><td class="mdescLeft">&#160;</td><td class="mdescRight">scatter grid quantity onto particles. only external fields are included  <a href="#a8a96c99996275cf03ceec41dc011695e">More...</a><br /></td></tr>
<tr class="separator:a8a96c99996275cf03ceec41dc011695e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3fe05fd157f9a0d3f09445660f038e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#add3fe05fd157f9a0d3f09445660f038e">scatter20err_beambunch</a> (innp, rays, tg, gam, chge, mass, tau, z, beamelem)</td></tr>
<tr class="memdesc:add3fe05fd157f9a0d3f09445660f038e"><td class="mdescLeft">&#160;</td><td class="mdescRight">scatter grid quantity onto particles.  <a href="#add3fe05fd157f9a0d3f09445660f038e">More...</a><br /></td></tr>
<tr class="separator:add3fe05fd157f9a0d3f09445660f038e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91563d467d36ccca8231ee2c62483246"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a91563d467d36ccca8231ee2c62483246">charge_beambunch</a> (this, innp, innx, inny, innz, ptsgeom, grid, chgdens, Flagbc, perdlen)</td></tr>
<tr class="memdesc:a91563d467d36ccca8231ee2c62483246"><td class="mdescLeft">&#160;</td><td class="mdescRight">All indices here are local to the processor. find charge density on grid from particles.  <a href="#a91563d467d36ccca8231ee2c62483246">More...</a><br /></td></tr>
<tr class="separator:a91563d467d36ccca8231ee2c62483246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf9a1a04b69a4b2509d80522112a3bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a2cf9a1a04b69a4b2509d80522112a3bd">setpts_beambunch</a> (this, inparticles, nptsin)</td></tr>
<tr class="separator:a2cf9a1a04b69a4b2509d80522112a3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b14b706bd1283ff6c5a7cec4b06c48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#af1b14b706bd1283ff6c5a7cec4b06c48">setnpt_beambunch</a> (this, innpt)</td></tr>
<tr class="memdesc:af1b14b706bd1283ff6c5a7cec4b06c48"><td class="mdescLeft">&#160;</td><td class="mdescRight">set local # of particles.  <a href="#af1b14b706bd1283ff6c5a7cec4b06c48">More...</a><br /></td></tr>
<tr class="separator:af1b14b706bd1283ff6c5a7cec4b06c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec332b229b76111b68db82b20ab2846e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aec332b229b76111b68db82b20ab2846e">getnpt_beambunch</a> (this, outnpt)</td></tr>
<tr class="memdesc:aec332b229b76111b68db82b20ab2846e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get local # of particles.  <a href="#aec332b229b76111b68db82b20ab2846e">More...</a><br /></td></tr>
<tr class="separator:aec332b229b76111b68db82b20ab2846e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc601844eaf85727173ebd3ef6d2b256"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#abc601844eaf85727173ebd3ef6d2b256">getpts_beambunch</a> (this, outparticles)</td></tr>
<tr class="separator:abc601844eaf85727173ebd3ef6d2b256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0438cba132ce3b2fdc8e053375c0097"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aa0438cba132ce3b2fdc8e053375c0097">deposit_beambunch</a> (innp, innx, inny, innz, rays, rho, ptsgeom, npx, npy, myidx, myidy)</td></tr>
<tr class="memdesc:aa0438cba132ce3b2fdc8e053375c0097"><td class="mdescLeft">&#160;</td><td class="mdescRight">deposit particles onto grid.  <a href="#aa0438cba132ce3b2fdc8e053375c0097">More...</a><br /></td></tr>
<tr class="separator:aa0438cba132ce3b2fdc8e053375c0097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe1e4d236f209b18f75b272bf07782d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a0fe1e4d236f209b18f75b272bf07782d">destruct_beambunch</a> (this)</td></tr>
<tr class="separator:a0fe1e4d236f209b18f75b272bf07782d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2d76ba15a23896de0838b2001d72b1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aef2d76ba15a23896de0838b2001d72b1">transfto_beambunch</a> (this, ptref)</td></tr>
<tr class="memdesc:aef2d76ba15a23896de0838b2001d72b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">transform the particle coordinates to local coordinate of "ptref". Here, "ptref" coordinate has a rotation "theta" in y-z plane with respect to the orginal coordinate.  <a href="#aef2d76ba15a23896de0838b2001d72b1">More...</a><br /></td></tr>
<tr class="separator:aef2d76ba15a23896de0838b2001d72b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d32b2a56cd1eb84867e95897af307a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a89d32b2a56cd1eb84867e95897af307a">transfback_beambunch</a> (this, ptref)</td></tr>
<tr class="separator:a89d32b2a56cd1eb84867e95897af307a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e93a990ca0c8071c035d078ffb7bb0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a05e93a990ca0c8071c035d078ffb7bb0">rotto_beambunch</a> (this, ptref, ptrange)</td></tr>
<tr class="memdesc:a05e93a990ca0c8071c035d078ffb7bb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">rotate to the particle coordinates to local beam coordinate of "ptref". Here, the local "z" direction has been enlarged by "gamma" for the space-charge calculation. Here, "ptref" coordinate has a rotation "theta" in x-z plane with respect to the orginal coordinate.  <a href="#a05e93a990ca0c8071c035d078ffb7bb0">More...</a><br /></td></tr>
<tr class="separator:a05e93a990ca0c8071c035d078ffb7bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4334f47908375d6a6dc12f1509397c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3b4334f47908375d6a6dc12f1509397c">rotback_beambunch</a> (this, ptref)</td></tr>
<tr class="separator:a3b4334f47908375d6a6dc12f1509397c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f485cba1b5e039b1a25b4b4bd9d81f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a82f485cba1b5e039b1a25b4b4bd9d81f">convzt_beambunch</a> (this)</td></tr>
<tr class="memdesc:a82f485cba1b5e039b1a25b4b4bd9d81f"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert from z coordinates (x,px,y,py,phase,pt0-pt) to t frame coordinates (x,px,y,py,z,pz). Here, x normalized by xl, px = gamma beta_x.  <a href="#a82f485cba1b5e039b1a25b4b4bd9d81f">More...</a><br /></td></tr>
<tr class="separator:a82f485cba1b5e039b1a25b4b4bd9d81f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d14e9a28575e2d4d173669b8e0356a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a9d14e9a28575e2d4d173669b8e0356a7">convtz_beambunch</a> (this, tout)</td></tr>
<tr class="memdesc:a9d14e9a28575e2d4d173669b8e0356a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear algorithm to transfer from t to z frame after bend. The Cartesian coordinate has been rotated following the exit direction of the reference particle. The exit angle of the reference particle should correspond to the bend angle.  <a href="#a9d14e9a28575e2d4d173669b8e0356a7">More...</a><br /></td></tr>
<tr class="separator:a9d14e9a28575e2d4d173669b8e0356a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8970622c75fe29b57d31607d71692976"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a8970622c75fe29b57d31607d71692976">drifthalft_beambunch</a> (this, t, tau)</td></tr>
<tr class="memdesc:a8970622c75fe29b57d31607d71692976"><td class="mdescLeft">&#160;</td><td class="mdescRight">drift half step in positions. Here, x, y, z are normalized by C * Dt tau - normalized step size (by Dt). the time "t" is normalized by the scaling frequency.  <a href="#a8970622c75fe29b57d31607d71692976">More...</a><br /></td></tr>
<tr class="separator:a8970622c75fe29b57d31607d71692976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a119b1d68c4a2a790014a9408c2db1575"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a119b1d68c4a2a790014a9408c2db1575">kickt_beambunch</a> (this, beamelem, z, tau, innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, flagerr)</td></tr>
<tr class="separator:a119b1d68c4a2a790014a9408c2db1575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da6bfdf683e278c6005fddbceac16db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3da6bfdf683e278c6005fddbceac16db">scattert_beambunch</a> (innp, innx, inny, innz, rays, refpt, exg</td></tr>
<tr class="memdesc:a3da6bfdf683e278c6005fddbceac16db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, the update of the momentum is in the rotated coordinates since the boost direction is not along z but in the x-z plane ue to the bend magnet.  <a href="#a3da6bfdf683e278c6005fddbceac16db">More...</a><br /></td></tr>
<tr class="separator:a3da6bfdf683e278c6005fddbceac16db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80dd0ce0010992cda1f2ba4d873371e0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a80dd0ce0010992cda1f2ba4d873371e0">scattert0_beambunch</a> (innp, rays, refpt, tg, chge, mass, dt, z, beamelem)</td></tr>
<tr class="memdesc:a80dd0ce0010992cda1f2ba4d873371e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, the update of the momentum is in the rotated coordinates since the boost direction is not along z but in the x-z plane due to the bend magnet. (Without Current)  <a href="#a80dd0ce0010992cda1f2ba4d873371e0">More...</a><br /></td></tr>
<tr class="separator:a80dd0ce0010992cda1f2ba4d873371e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f7f46438747a0fb811de64b1ed95aa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a02f7f46438747a0fb811de64b1ed95aa">kick1wake_beambunch</a> (this, tau, innx, inny, innz, temppoten</td></tr>
<tr class="separator:a02f7f46438747a0fb811de64b1ed95aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530cca8371b8decda64389ce29d10bcd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a530cca8371b8decda64389ce29d10bcd">kick2wake_beambunch</a> (this, beamelem, z, tau, innx, inny, inn</td></tr>
<tr class="separator:a530cca8371b8decda64389ce29d10bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17d706a08d23a054bf547514e796e6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aa17d706a08d23a054bf547514e796e6a">scatter2wake_beambunch</a> (innp, innx, inny, innz, rays, exg, eyg, ezg, ptsgeom, npx, npy, myidx, myidy, tg, gam, curr, chge, mass, tau, z,</td></tr>
<tr class="separator:aa17d706a08d23a054bf547514e796e6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2395bc91f4fc52175d8a5cc92890bb83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a2395bc91f4fc52175d8a5cc92890bb83">scatter2errwake_beambunch</a> (innp, innx, inny, innz, rays, ex</td></tr>
<tr class="separator:a2395bc91f4fc52175d8a5cc92890bb83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class defines the charged particle beam bunch information in the accelerator. </p>
<dl class="section author"><dt>Author</dt><dd>Ji Qiang, LBNL </dd></dl>
</div><hr/><h2 class="groupheader">Data Type Documentation</h2>
<a name="structbeambunchclass_1_1beambunch" id="structbeambunchclass_1_1beambunch"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structbeambunchclass_1_1beambunch">&#9670;&nbsp;</a></span>beambunchclass::beambunch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type beambunchclass::beambunch</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"></div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a555bb0dc53871a3f69755125598c8938"></a>double precision</td>
<td class="fieldname">
charge</td>
<td class="fielddoc">
beam freq, current, part. mass and charge. </td></tr>
<tr><td class="fieldtype">
<a id="a0611d8fb67f60eb1ea7a3df79c5de915"></a>double precision</td>
<td class="fieldname">
current</td>
<td class="fielddoc">
beam freq, current, part. mass and charge. </td></tr>
<tr><td class="fieldtype">
<a id="abeaad3b1ce823a9c49cab5a8b96f5ff0"></a>double precision</td>
<td class="fieldname">
mass</td>
<td class="fielddoc">
beam freq, current, part. mass and charge. </td></tr>
<tr><td class="fieldtype">
<a id="a20f5303645e1b7fa0cbfa88f81cda947"></a>integer</td>
<td class="fieldname">
npt</td>
<td class="fielddoc">
# of total global macroparticles and local particles </td></tr>
<tr><td class="fieldtype">
<a id="a71a8687235fdc19d862fb13092b714a3"></a>integer</td>
<td class="fieldname">
nptlocal</td>
<td class="fielddoc">
# of total global macroparticles and local particles </td></tr>
<tr><td class="fieldtype">
<a id="af0d19c1e3e537ade010af8554783c8d7"></a>double precision, dimension(:,:), pointer</td>
<td class="fieldname">
pts1</td>
<td class="fielddoc">
particles type one. </td></tr>
<tr><td class="fieldtype">
<a id="a973e0e4ee1b24185bac1d727d2c074f5"></a>double precision, dimension(6)</td>
<td class="fieldname">
refptcl</td>
<td class="fielddoc">
reference particle </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a91563d467d36ccca8231ee2c62483246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91563d467d36ccca8231ee2c62483246">&#9670;&nbsp;</a></span>charge_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::charge_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom), intent(in)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (pgrid2d), intent(in)&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chgdens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Flagbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>perdlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>All indices here are local to the processor. find charge density on grid from particles. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_cgraph.png" border="0" usemap="#namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_cgraph" id="namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_cgraph">
<area shape="rect"  title="All indices here are local to the processor. find charge density on grid from particles." alt="" coords="5,289,175,328"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="464,193,604,232"/>
<area shape="rect"  href="namespacepgrid2dclass.html#ac088657db5b1deb05bb1ec732579ba53" title="get the total number of PEs, PEs in column and row communicators." alt="" coords="461,320,607,359"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a559d4550356f88440ae55fceda480de2" title="get my rank position in 2d, column, and row communicators." alt="" coords="460,385,608,424"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a550cb1b5c94a9e168c3e0108bb8a6d5b" title="get 2D, column, and row communicators." alt="" coords="455,453,613,492"/>
<area shape="rect"  href="namespacebeambunchclass.html#aa0438cba132ce3b2fdc8e053375c0097" title="deposit particles onto grid." alt="" coords="223,131,395,169"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="454,256,614,295"/>
<area shape="rect"  href="namespacefldmgerclass.html#a54886b0763b8458a0560ccf7087b07f1" title="sum up the contributions from neighboring guard cells." alt="" coords="224,347,394,385"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="674,232,813,257"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="449,68,620,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="449,131,619,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="443,5,626,44"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_icgraph.png" border="0" usemap="#namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_icgraph" id="namespacebeambunchclass_a91563d467d36ccca8231ee2c62483246_icgraph">
<area shape="rect"  title="All indices here are local to the processor. find charge density on grid from particles." alt="" coords="286,5,455,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="ac5b1c15c02703f7339b67283bc9816bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5b1c15c02703f7339b67283bc9816bd">&#9670;&nbsp;</a></span>chgupdate_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::chgupdate_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nchge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>idchgold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>qmcclist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update the total current fraction of each charge state update total # of ptcl for each charge state </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_ac5b1c15c02703f7339b67283bc9816bd_icgraph.png" border="0" usemap="#namespacebeambunchclass_ac5b1c15c02703f7339b67283bc9816bd_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_ac5b1c15c02703f7339b67283bc9816bd_icgraph" id="namespacebeambunchclass_ac5b1c15c02703f7339b67283bc9816bd_icgraph">
<area shape="rect"  title="update the total current fraction of each charge state update total # of ptcl for each charge state" alt="" coords="286,5,477,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a1605e527eb41043dc5962da1e3bb5159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1605e527eb41043dc5962da1e3bb5159">&#9670;&nbsp;</a></span>construct_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::construct_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>incurr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>inkin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>inmass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>incharge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a1605e527eb41043dc5962da1e3bb5159_icgraph.png" border="0" usemap="#namespacebeambunchclass_a1605e527eb41043dc5962da1e3bb5159_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a1605e527eb41043dc5962da1e3bb5159_icgraph" id="namespacebeambunchclass_a1605e527eb41043dc5962da1e3bb5159_icgraph">
<area shape="rect"  title=" " alt="" coords="187,5,370,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#a6a90186281758191cfa3ef4fc9c54078" title="set up objects and parameters." alt="" coords="5,5,139,44"/>
</map>
</div>

</div>
</div>
<a id="ad456951b863b3dfab6eb7fa018e17230"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad456951b863b3dfab6eb7fa018e17230">&#9670;&nbsp;</a></span>conv0th_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::conv0th_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nplc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nptot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6), intent(out)&#160;</td>
          <td class="paramname"><em>ptrange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Flagbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>perd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>xrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>yrad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>from z to t beam frame 0th order transformation. </p>

</div>
</div>
<a id="a374fdc0e530a8835113fcd674283a150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a374fdc0e530a8835113fcd674283a150">&#9670;&nbsp;</a></span>conv0thold_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::conv0thold_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nplc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nptot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>from z to t beam frame 0th order approximation. </p>

</div>
</div>
<a id="a0b46fd8b4c41577688761ad62175772b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b46fd8b4c41577688761ad62175772b">&#9670;&nbsp;</a></span>conv1st_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::conv1st_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nplc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nptot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6), intent(out)&#160;</td>
          <td class="paramname"><em>ptrange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Flagbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>perd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>xrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>yrad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>from z to t beam frame 1st order transformation. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a0b46fd8b4c41577688761ad62175772b_icgraph.png" border="0" usemap="#namespacebeambunchclass_a0b46fd8b4c41577688761ad62175772b_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a0b46fd8b4c41577688761ad62175772b_icgraph" id="namespacebeambunchclass_a0b46fd8b4c41577688761ad62175772b_icgraph">
<area shape="rect"  title="from z to t beam frame 1st order transformation." alt="" coords="286,5,460,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="ad12625a90fb4a096ff15ba55f655b148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad12625a90fb4a096ff15ba55f655b148">&#9670;&nbsp;</a></span>convback0th_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::convback0th_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>0th order algorithm to transfer from t to z frame. </p>

</div>
</div>
<a id="a704068cca17e98c6568c1e6056d1c4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a704068cca17e98c6568c1e6056d1c4d6">&#9670;&nbsp;</a></span>convback1st_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::convback1st_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linear algorithm to transfer from t to z frame. </p>

</div>
</div>
<a id="a030c80c97cd3523478e56fdaff0e7560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a030c80c97cd3523478e56fdaff0e7560">&#9670;&nbsp;</a></span>convforth0th_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::convforth0th_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>0th order algorithm to transfer from z to t frame. </p>

</div>
</div>
<a id="a35f6511340579ba6bb5f07bebf6d09d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35f6511340579ba6bb5f07bebf6d09d5">&#9670;&nbsp;</a></span>convforth1st_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::convforth1st_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linear(1st order) algorithm to transfer from z to t frame. </p>

</div>
</div>
<a id="a9d14e9a28575e2d4d173669b8e0356a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d14e9a28575e2d4d173669b8e0356a7">&#9670;&nbsp;</a></span>convtz_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::convtz_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>tout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Linear algorithm to transfer from t to z frame after bend. The Cartesian coordinate has been rotated following the exit direction of the reference particle. The exit angle of the reference particle should correspond to the bend angle. </p>

</div>
</div>
<a id="a82f485cba1b5e039b1a25b4b4bd9d81f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82f485cba1b5e039b1a25b4b4bd9d81f">&#9670;&nbsp;</a></span>convzt_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::convzt_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>convert from z coordinates (x,px,y,py,phase,pt0-pt) to t frame coordinates (x,px,y,py,z,pz). Here, x normalized by xl, px = gamma beta_x. </p>
<p>The following steps go from z to t frame. 2) Linear algorithm to transfer from z to t frame. </p>

</div>
</div>
<a id="acacb775484bda2729c3da9adbbeffc53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acacb775484bda2729c3da9adbbeffc53">&#9670;&nbsp;</a></span>cvbkforth1st_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::cvbkforth1st_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_acacb775484bda2729c3da9adbbeffc53_icgraph.png" border="0" usemap="#namespacebeambunchclass_acacb775484bda2729c3da9adbbeffc53_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_acacb775484bda2729c3da9adbbeffc53_icgraph" id="namespacebeambunchclass_acacb775484bda2729c3da9adbbeffc53_icgraph">
<area shape="rect"  title=" " alt="" coords="286,5,486,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="aa0438cba132ce3b2fdc8e053375c0097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0438cba132ce3b2fdc8e053375c0097">&#9670;&nbsp;</a></span>deposit_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::deposit_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9, innp), intent(in)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>deposit particles onto grid. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_cgraph.png" border="0" usemap="#namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_cgraph" id="namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_cgraph">
<area shape="rect"  title="deposit particles onto grid." alt="" coords="5,131,177,169"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="247,5,387,44"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="231,68,402,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="231,131,402,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="225,193,408,232"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="236,256,397,295"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="456,137,595,163"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_icgraph.png" border="0" usemap="#namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_icgraph" id="namespacebeambunchclass_aa0438cba132ce3b2fdc8e053375c0097_icgraph">
<area shape="rect"  title="deposit particles onto grid." alt="" coords="503,5,675,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a91563d467d36ccca8231ee2c62483246" title="All indices here are local to the processor. find charge density on grid from particles." alt="" coords="286,5,455,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a0fe1e4d236f209b18f75b272bf07782d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe1e4d236f209b18f75b272bf07782d">&#9670;&nbsp;</a></span>destruct_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::destruct_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(out)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a0fe1e4d236f209b18f75b272bf07782d_icgraph.png" border="0" usemap="#namespacebeambunchclass_a0fe1e4d236f209b18f75b272bf07782d_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a0fe1e4d236f209b18f75b272bf07782d_icgraph" id="namespacebeambunchclass_a0fe1e4d236f209b18f75b272bf07782d_icgraph">
<area shape="rect"  title=" " alt="" coords="303,5,479,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#a7bcc6275f447513b2ea5d85d46aade2a" title=" " alt="" coords="104,5,255,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a212c0d38a812d95f238d7da7f29ac17c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a212c0d38a812d95f238d7da7f29ac17c">&#9670;&nbsp;</a></span>drift1_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::drift1_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(inout)&#160;</td>
          <td class="paramname"><em>beamln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>bitype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ih</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drift beam half step using linear map for external field. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a212c0d38a812d95f238d7da7f29ac17c_cgraph.png" border="0" usemap="#namespacebeambunchclass_a212c0d38a812d95f238d7da7f29ac17c_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a212c0d38a812d95f238d7da7f29ac17c_cgraph" id="namespacebeambunchclass_a212c0d38a812d95f238d7da7f29ac17c_cgraph">
<area shape="rect"  title="Drift beam half step using linear map for external field." alt="" coords="5,91,164,129"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="227,28,367,67"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a76cac49c6e8615751de8c9f8bbba2641" title=" " alt="" coords="212,465,382,504"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="217,91,377,129"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="453,35,592,60"/>
<area shape="rect"  href="namespacequadrupoleclass.html#adcdf5386d19cfb0a90cbc42426cf0d44" title=" " alt="" coords="430,84,614,123"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aaf41c0aaec4dc3e16fc0f678b3220de3" title=" " alt="" coords="439,147,605,185"/>
<area shape="rect"  href="namespacecclclass.html#a2efbf5186624893a0f213ca40968c198" title=" " alt="" coords="443,209,601,235"/>
<area shape="rect"  href="namespaceccdtlclass.html#a520796b320588e1f31ce8587301b571b" title=" " alt="" coords="450,284,595,323"/>
<area shape="rect"  href="namespacedtlclass.html#afcf262e9f63f2008931d898ff6d9973a" title=" " alt="" coords="446,399,599,424"/>
<area shape="rect"  href="namespacescclass.html#aec786348c1a0beec0d090c12b13d588c" title=" " alt="" coords="446,472,598,497"/>
<area shape="rect"  href="namespaceconstfocclass.html#af393c0fed039b82c7eb2aa347bc12bd8" title=" " alt="" coords="439,532,606,571"/>
<area shape="rect"  href="namespacesolrfclass.html#a70f5e9afe73a56ed66363e6ca3207226" title=" " alt="" coords="451,607,594,645"/>
<area shape="rect"  href="namespacesolclass.html#ac1f4d73224d7585c1be1bb6f24f125df" title=" " alt="" coords="443,695,602,720"/>
<area shape="rect"  href="namespaceemfldclass.html#ab283b339abd3df592d8200c244652131" title=" " alt="" coords="447,771,597,809"/>
<area shape="rect"  href="namespacemultipoleclass.html#ab9ed6db5fa3b4ea0f6e1a07cd6d57431" title=" " alt="" coords="437,855,608,893"/>
<area shape="rect"  href="namespacetwsclass.html#ab57cbdca9514adc28eb62c6bbb8633b6" title=" " alt="" coords="440,955,605,980"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a156f69f00644d8511e9f1ee150504b83" title=" " alt="" coords="665,5,813,44"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a3cbe01df676294387d1293468425aa70" title=" " alt="" coords="864,5,1036,44"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a28a961157d94669d59f8c6f024995899" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="1084,5,1258,44"/>
<area shape="rect"  href="namespacedrifttubeclass.html#a186a18efb61fce23e16a18534af446fb" title=" " alt="" coords="675,68,803,107"/>
<area shape="rect"  href="namespacedrifttubeclass.html#a053027aad7a9b20bafb34d676de9a14a" title=" " alt="" coords="873,68,1027,107"/>
<area shape="rect"  href="namespacecclclass.html#a881db4a51cdc73a6c489b2814565a243" title="interpolate the field from the CCL rf cavity onto bunch location." alt="" coords="1095,157,1248,183"/>
<area shape="rect"  href="namespacecclclass.html#a6dd4075592b69b308b61e3ee2f065517" title=" " alt="" coords="679,183,799,208"/>
<area shape="rect"  href="namespacecclclass.html#a09adb3ba980646f12eb22fddbd4c962d" title=" " alt="" coords="877,183,1023,208"/>
<area shape="rect"  href="namespaceccdtlclass.html#adb7b1c30d3fcb087a5064911ccd4fd1d" title="interpolate the field from the CCDTL rf cavity onto bunch location." alt="" coords="1101,256,1242,295"/>
<area shape="rect"  href="namespaceccdtlclass.html#aca1c6ac6cdbd554820ab2c213a987647" title=" " alt="" coords="668,291,811,316"/>
<area shape="rect"  href="namespaceccdtlclass.html#afad7c4471295ba39993a4a180d6a4d54" title=" " alt="" coords="883,284,1017,323"/>
<area shape="rect"  href="namespacedtlclass.html#a1fb756446dfd217cc32e4a9088e7f4c7" title="interpolate the field from the DTL rf cavity onto bunch location." alt="" coords="1097,348,1246,373"/>
<area shape="rect"  href="namespacedtlclass.html#aa1988f1526102adea7683c31ce2164d9" title=" " alt="" coords="681,399,797,424"/>
<area shape="rect"  href="namespacedtlclass.html#a913997c12a39f072f1a2be1576dc59d2" title=" " alt="" coords="879,399,1021,424"/>
<area shape="rect"  href="namespacedtlclass.html#a79f0618eb609338c97470f6f8f05a848" title=" " alt="" coords="1091,399,1252,424"/>
<area shape="rect"  href="namespacescclass.html#aefc9ea62cf36830e2c74869fff2f1b17" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="1098,475,1245,500"/>
<area shape="rect"  href="namespacescclass.html#a4b16987e1d3852123c69a6bfc0cec75a" title=" " alt="" coords="682,500,796,525"/>
<area shape="rect"  href="namespacescclass.html#a5d354b33de72df0b6be68290744f94ba" title=" " alt="" coords="880,500,1020,525"/>
<area shape="rect"  href="namespaceconstfocclass.html#a25aa498c0852e2952880172b61f0f034" title=" " alt="" coords="674,549,804,588"/>
<area shape="rect"  href="namespaceconstfocclass.html#a6cedac4005af8166900c4d4b1afd707b" title=" " alt="" coords="872,549,1028,588"/>
<area shape="rect"  href="namespacesolrfclass.html#a1033b422b682ef72ecc3b482c38b5065" title="interpolate the field from the SolRF rf cavity onto bunch location." alt="" coords="1102,607,1240,645"/>
<area shape="rect"  href="namespacesolrfclass.html#a47bcede8ab38e0e035ef1be479490018" title=" " alt="" coords="670,668,808,693"/>
<area shape="rect"  href="namespacesolrfclass.html#aaf806853862c8c4b3f448ca750500178" title=" " alt="" coords="884,664,1015,703"/>
<area shape="rect"  href="namespacesolrfclass.html#adf7673f885573c8468f07faebc432d7d" title=" " alt="" coords="1096,669,1247,708"/>
<area shape="rect"  href="namespacesolclass.html#ae384372c54c045759b9bb9e1eb0886a1" title=" " alt="" coords="678,724,800,749"/>
<area shape="rect"  href="namespacesolclass.html#a195ad6d94c20d0ac4d6ed1c8063a8a3b" title=" " alt="" coords="876,727,1024,752"/>
<area shape="rect"  href="namespaceemfldclass.html#ae77f42a7f667c3dd902df1d26480e602" title=" " alt="" coords="1093,800,1249,839"/>
<area shape="rect"  href="namespaceemfldclass.html#ae4bfa1325df7cec4a3facbe8ebc66845" title=" " alt="" coords="662,831,816,856"/>
<area shape="rect"  href="namespaceemfldclass.html#af90bd5467acb5c62a2d93f6eb1738097" title=" " alt="" coords="881,828,1019,867"/>
<area shape="rect"  href="namespacemultipoleclass.html#aebbed53759ae97dc55df35264c89274c" title=" " alt="" coords="672,887,806,925"/>
<area shape="rect"  href="namespacemultipoleclass.html#adba27354e821268f6cb786c415a5bc91" title=" " alt="" coords="870,891,1030,929"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="1091,891,1252,929"/>
<area shape="rect"  href="namespacetwsclass.html#a9c88e1753c1d3faff3af95cf8c071d4f" title="get the E field on the axis" alt="" coords="1091,980,1252,1005"/>
<area shape="rect"  href="namespacetwsclass.html#a2d527684d5c9fd42e3217ac03914bd90" title=" " alt="" coords="675,1005,803,1031"/>
<area shape="rect"  href="namespacetwsclass.html#a1681f57f6e70160ddb0f6e59f4cd5349" title=" " alt="" coords="873,1005,1027,1031"/>
</map>
</div>

</div>
</div>
<a id="a3be2b49f0fef567493258758c44fffd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3be2b49f0fef567493258758c44fffd6">&#9670;&nbsp;</a></span>drift1org_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::drift1org_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(inout)&#160;</td>
          <td class="paramname"><em>beamln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drift beam half step using linear map for external field. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a3be2b49f0fef567493258758c44fffd6_cgraph.png" border="0" usemap="#namespacebeambunchclass_a3be2b49f0fef567493258758c44fffd6_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a3be2b49f0fef567493258758c44fffd6_cgraph" id="namespacebeambunchclass_a3be2b49f0fef567493258758c44fffd6_cgraph">
<area shape="rect"  title="Drift beam half step using linear map for external field." alt="" coords="5,91,183,129"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="246,28,386,67"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a76cac49c6e8615751de8c9f8bbba2641" title=" " alt="" coords="231,465,401,504"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="236,91,397,129"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="472,35,611,60"/>
<area shape="rect"  href="namespacequadrupoleclass.html#adcdf5386d19cfb0a90cbc42426cf0d44" title=" " alt="" coords="449,84,634,123"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aaf41c0aaec4dc3e16fc0f678b3220de3" title=" " alt="" coords="459,147,624,185"/>
<area shape="rect"  href="namespacecclclass.html#a2efbf5186624893a0f213ca40968c198" title=" " alt="" coords="463,209,620,235"/>
<area shape="rect"  href="namespaceccdtlclass.html#a520796b320588e1f31ce8587301b571b" title=" " alt="" coords="469,284,614,323"/>
<area shape="rect"  href="namespacedtlclass.html#afcf262e9f63f2008931d898ff6d9973a" title=" " alt="" coords="465,399,618,424"/>
<area shape="rect"  href="namespacescclass.html#aec786348c1a0beec0d090c12b13d588c" title=" " alt="" coords="466,472,617,497"/>
<area shape="rect"  href="namespaceconstfocclass.html#af393c0fed039b82c7eb2aa347bc12bd8" title=" " alt="" coords="458,532,625,571"/>
<area shape="rect"  href="namespacesolrfclass.html#a70f5e9afe73a56ed66363e6ca3207226" title=" " alt="" coords="470,607,613,645"/>
<area shape="rect"  href="namespacesolclass.html#ac1f4d73224d7585c1be1bb6f24f125df" title=" " alt="" coords="462,695,621,720"/>
<area shape="rect"  href="namespaceemfldclass.html#ab283b339abd3df592d8200c244652131" title=" " alt="" coords="466,771,617,809"/>
<area shape="rect"  href="namespacemultipoleclass.html#ab9ed6db5fa3b4ea0f6e1a07cd6d57431" title=" " alt="" coords="456,855,627,893"/>
<area shape="rect"  href="namespacetwsclass.html#ab57cbdca9514adc28eb62c6bbb8633b6" title=" " alt="" coords="459,955,624,980"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a156f69f00644d8511e9f1ee150504b83" title=" " alt="" coords="685,5,832,44"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a3cbe01df676294387d1293468425aa70" title=" " alt="" coords="883,5,1056,44"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a28a961157d94669d59f8c6f024995899" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="1104,5,1278,44"/>
<area shape="rect"  href="namespacedrifttubeclass.html#a186a18efb61fce23e16a18534af446fb" title=" " alt="" coords="694,68,823,107"/>
<area shape="rect"  href="namespacedrifttubeclass.html#a053027aad7a9b20bafb34d676de9a14a" title=" " alt="" coords="892,68,1046,107"/>
<area shape="rect"  href="namespacecclclass.html#a881db4a51cdc73a6c489b2814565a243" title="interpolate the field from the CCL rf cavity onto bunch location." alt="" coords="1114,157,1267,183"/>
<area shape="rect"  href="namespacecclclass.html#a6dd4075592b69b308b61e3ee2f065517" title=" " alt="" coords="698,183,819,208"/>
<area shape="rect"  href="namespacecclclass.html#a09adb3ba980646f12eb22fddbd4c962d" title=" " alt="" coords="896,183,1042,208"/>
<area shape="rect"  href="namespaceccdtlclass.html#adb7b1c30d3fcb087a5064911ccd4fd1d" title="interpolate the field from the CCDTL rf cavity onto bunch location." alt="" coords="1120,256,1261,295"/>
<area shape="rect"  href="namespaceccdtlclass.html#aca1c6ac6cdbd554820ab2c213a987647" title=" " alt="" coords="687,291,830,316"/>
<area shape="rect"  href="namespaceccdtlclass.html#afad7c4471295ba39993a4a180d6a4d54" title=" " alt="" coords="903,284,1036,323"/>
<area shape="rect"  href="namespacedtlclass.html#a1fb756446dfd217cc32e4a9088e7f4c7" title="interpolate the field from the DTL rf cavity onto bunch location." alt="" coords="1116,348,1265,373"/>
<area shape="rect"  href="namespacedtlclass.html#aa1988f1526102adea7683c31ce2164d9" title=" " alt="" coords="700,399,816,424"/>
<area shape="rect"  href="namespacedtlclass.html#a913997c12a39f072f1a2be1576dc59d2" title=" " alt="" coords="899,399,1040,424"/>
<area shape="rect"  href="namespacedtlclass.html#a79f0618eb609338c97470f6f8f05a848" title=" " alt="" coords="1110,399,1271,424"/>
<area shape="rect"  href="namespacescclass.html#aefc9ea62cf36830e2c74869fff2f1b17" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="1117,475,1264,500"/>
<area shape="rect"  href="namespacescclass.html#a4b16987e1d3852123c69a6bfc0cec75a" title=" " alt="" coords="701,500,816,525"/>
<area shape="rect"  href="namespacescclass.html#a5d354b33de72df0b6be68290744f94ba" title=" " alt="" coords="899,500,1039,525"/>
<area shape="rect"  href="namespaceconstfocclass.html#a25aa498c0852e2952880172b61f0f034" title=" " alt="" coords="693,549,823,588"/>
<area shape="rect"  href="namespaceconstfocclass.html#a6cedac4005af8166900c4d4b1afd707b" title=" " alt="" coords="892,549,1047,588"/>
<area shape="rect"  href="namespacesolrfclass.html#a1033b422b682ef72ecc3b482c38b5065" title="interpolate the field from the SolRF rf cavity onto bunch location." alt="" coords="1121,607,1260,645"/>
<area shape="rect"  href="namespacesolrfclass.html#a47bcede8ab38e0e035ef1be479490018" title=" " alt="" coords="689,668,828,693"/>
<area shape="rect"  href="namespacesolrfclass.html#aaf806853862c8c4b3f448ca750500178" title=" " alt="" coords="904,664,1035,703"/>
<area shape="rect"  href="namespacesolrfclass.html#adf7673f885573c8468f07faebc432d7d" title=" " alt="" coords="1115,669,1266,708"/>
<area shape="rect"  href="namespacesolclass.html#ae384372c54c045759b9bb9e1eb0886a1" title=" " alt="" coords="697,724,819,749"/>
<area shape="rect"  href="namespacesolclass.html#a195ad6d94c20d0ac4d6ed1c8063a8a3b" title=" " alt="" coords="896,727,1043,752"/>
<area shape="rect"  href="namespaceemfldclass.html#ae77f42a7f667c3dd902df1d26480e602" title=" " alt="" coords="1112,800,1269,839"/>
<area shape="rect"  href="namespaceemfldclass.html#ae4bfa1325df7cec4a3facbe8ebc66845" title=" " alt="" coords="682,831,835,856"/>
<area shape="rect"  href="namespaceemfldclass.html#af90bd5467acb5c62a2d93f6eb1738097" title=" " alt="" coords="900,828,1038,867"/>
<area shape="rect"  href="namespacemultipoleclass.html#aebbed53759ae97dc55df35264c89274c" title=" " alt="" coords="691,887,825,925"/>
<area shape="rect"  href="namespacemultipoleclass.html#adba27354e821268f6cb786c415a5bc91" title=" " alt="" coords="890,891,1049,929"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="1110,891,1271,929"/>
<area shape="rect"  href="namespacetwsclass.html#a9c88e1753c1d3faff3af95cf8c071d4f" title="get the E field on the axis" alt="" coords="1110,980,1271,1005"/>
<area shape="rect"  href="namespacetwsclass.html#a2d527684d5c9fd42e3217ac03914bd90" title=" " alt="" coords="694,1005,822,1031"/>
<area shape="rect"  href="namespacetwsclass.html#a1681f57f6e70160ddb0f6e59f4cd5349" title=" " alt="" coords="893,1005,1046,1031"/>
</map>
</div>

</div>
</div>
<a id="a6e3aecf1a2cf3d54950c09c603c2f11c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e3aecf1a2cf3d54950c09c603c2f11c">&#9670;&nbsp;</a></span>drift2_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::drift2_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>drift half step using nonlinear Lorentz integrator </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a6e3aecf1a2cf3d54950c09c603c2f11c_cgraph.png" border="0" usemap="#namespacebeambunchclass_a6e3aecf1a2cf3d54950c09c603c2f11c_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a6e3aecf1a2cf3d54950c09c603c2f11c_cgraph" id="namespacebeambunchclass_a6e3aecf1a2cf3d54950c09c603c2f11c_cgraph">
<area shape="rect"  title="drift half step using nonlinear Lorentz integrator" alt="" coords="5,37,164,76"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="222,5,362,44"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="212,68,372,107"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="420,44,560,69"/>
</map>
</div>

</div>
</div>
<a id="a3f5a86fb4b3ff5b33efdfa76b1c52ce4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f5a86fb4b3ff5b33efdfa76b1c52ce4">&#9670;&nbsp;</a></span>drift2halo_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::drift2halo_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>drift half step using nonlinear Lorentz integrator for halo study </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a3f5a86fb4b3ff5b33efdfa76b1c52ce4_cgraph.png" border="0" usemap="#namespacebeambunchclass_a3f5a86fb4b3ff5b33efdfa76b1c52ce4_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a3f5a86fb4b3ff5b33efdfa76b1c52ce4_cgraph" id="namespacebeambunchclass_a3f5a86fb4b3ff5b33efdfa76b1c52ce4_cgraph">
<area shape="rect"  title="drift half step using nonlinear Lorentz integrator for halo study" alt="" coords="5,37,189,76"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="247,5,387,44"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="237,68,398,107"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="446,44,585,69"/>
</map>
</div>

</div>
</div>
<a id="a8970622c75fe29b57d31607d71692976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8970622c75fe29b57d31607d71692976">&#9670;&nbsp;</a></span>drifthalft_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::drifthalft_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>drift half step in positions. Here, x, y, z are normalized by C * Dt tau - normalized step size (by Dt). the time "t" is normalized by the scaling frequency. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a8970622c75fe29b57d31607d71692976_cgraph.png" border="0" usemap="#namespacebeambunchclass_a8970622c75fe29b57d31607d71692976_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a8970622c75fe29b57d31607d71692976_cgraph" id="namespacebeambunchclass_a8970622c75fe29b57d31607d71692976_cgraph">
<area shape="rect"  title="drift half step in positions. Here, x, y, z are normalized by C * Dt tau &#45; normalized step size (by D..." alt="" coords="5,5,182,44"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="230,5,390,44"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="438,12,577,37"/>
</map>
</div>

</div>
</div>
<a id="aea8cfefa2f70ade95202cc40f015f7bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea8cfefa2f70ade95202cc40f015f7bf">&#9670;&nbsp;</a></span>geomerrl_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::geomerrl_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>shift and rotate the beam at the leading edge of the element </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_cgraph.png" border="0" usemap="#namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_cgraph" id="namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_cgraph">
<area shape="rect"  title="shift and rotate the beam at the leading edge of the element" alt="" coords="5,5,187,44"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#aa02696ccb3d6d48bfdcb0ff3ea906fa1" title=" " alt="" coords="235,5,381,44"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_icgraph.png" border="0" usemap="#namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_icgraph" id="namespacebeambunchclass_aea8cfefa2f70ade95202cc40f015f7bf_icgraph">
<area shape="rect"  title="shift and rotate the beam at the leading edge of the element" alt="" coords="286,5,467,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="ab2f6f9e95d5786dab15c1b73f305e349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f6f9e95d5786dab15c1b73f305e349">&#9670;&nbsp;</a></span>geomerrt_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::geomerrt_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>shift and rotate the beam at the tail edge of the element </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_cgraph.png" border="0" usemap="#namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_cgraph" id="namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_cgraph">
<area shape="rect"  title="shift and rotate the beam at the tail edge of the element" alt="" coords="5,5,187,44"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#aa02696ccb3d6d48bfdcb0ff3ea906fa1" title=" " alt="" coords="235,5,382,44"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_icgraph.png" border="0" usemap="#namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_icgraph" id="namespacebeambunchclass_ab2f6f9e95d5786dab15c1b73f305e349_icgraph">
<area shape="rect"  title="shift and rotate the beam at the tail edge of the element" alt="" coords="286,5,468,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="aec332b229b76111b68db82b20ab2846e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec332b229b76111b68db82b20ab2846e">&#9670;&nbsp;</a></span>getnpt_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::getnpt_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>outnpt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get local # of particles. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aec332b229b76111b68db82b20ab2846e_icgraph.png" border="0" usemap="#namespacebeambunchclass_aec332b229b76111b68db82b20ab2846e_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_aec332b229b76111b68db82b20ab2846e_icgraph" id="namespacebeambunchclass_aec332b229b76111b68db82b20ab2846e_icgraph">
<area shape="rect"  title="get local # of particles." alt="" coords="187,5,353,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#a6a90186281758191cfa3ef4fc9c54078" title="set up objects and parameters." alt="" coords="5,5,139,44"/>
</map>
</div>

</div>
</div>
<a id="abc601844eaf85727173ebd3ef6d2b256"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc601844eaf85727173ebd3ef6d2b256">&#9670;&nbsp;</a></span>getpts_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::getpts_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(in)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>outparticles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abf23fdc1e8ca69fe7fe8f2995fbc1bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf23fdc1e8ca69fe7fe8f2995fbc1bcc">&#9670;&nbsp;</a></span>kick1_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::kick1_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>temppotent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom), intent(in)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (pgrid2d), intent(in)&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Flagbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>perdlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Here, all indices of potential are local to processor. Advance the particles in the velocity space using the force from the external field and the self space charge force interpolated from the grid to particles. (linear map) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_abf23fdc1e8ca69fe7fe8f2995fbc1bcc_cgraph.png" border="0" usemap="#namespacebeambunchclass_abf23fdc1e8ca69fe7fe8f2995fbc1bcc_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_abf23fdc1e8ca69fe7fe8f2995fbc1bcc_cgraph" id="namespacebeambunchclass_abf23fdc1e8ca69fe7fe8f2995fbc1bcc_cgraph">
<area shape="rect"  title="Here, all indices of potential are local to processor. Advance the particles in the velocity space us..." alt="" coords="5,195,165,233"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="458,193,598,232"/>
<area shape="rect"  href="namespacepgrid2dclass.html#ac088657db5b1deb05bb1ec732579ba53" title="get the total number of PEs, PEs in column and row communicators." alt="" coords="455,5,601,44"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a559d4550356f88440ae55fceda480de2" title="get my rank position in 2d, column, and row communicators." alt="" coords="455,68,602,107"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="443,444,614,483"/>
<area shape="rect"  href="namespacefldmgerclass.html#a028236bf0d8419b6f75a7fb28eb7226b" title="exchange grid information between neighboring guard cell to calculate E from phi." alt="" coords="214,103,387,141"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="448,256,609,295"/>
<area shape="rect"  href="namespacefldmgerclass.html#a490fceb1792fb1664488b1394dcff5f0" title="exchange the information for interpolation from neighboring guard cells." alt="" coords="220,165,382,204"/>
<area shape="rect"  href="namespacebeambunchclass.html#a023a12f9279f0764fc57deda1bcb852f" title="scatter grid quantity onto particles using linear map." alt="" coords="213,331,389,369"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="668,232,807,257"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a550cb1b5c94a9e168c3e0108bb8a6d5b" title="get 2D, column, and row communicators." alt="" coords="449,131,607,169"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="443,319,613,357"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="437,381,620,420"/>
</map>
</div>

</div>
</div>
<a id="a02f7f46438747a0fb811de64b1ed95aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f7f46438747a0fb811de64b1ed95aa">&#9670;&nbsp;</a></span>kick1wake_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::kick1wake_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>temppoten</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_cgraph.png" border="0" usemap="#namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_cgraph" id="namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_cgraph">
<area shape="rect"  title=" " alt="" coords="5,216,196,255"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="489,193,629,232"/>
<area shape="rect"  href="namespacepgrid2dclass.html#ac088657db5b1deb05bb1ec732579ba53" title="get the total number of PEs, PEs in column and row communicators." alt="" coords="486,5,632,44"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a559d4550356f88440ae55fceda480de2" title="get my rank position in 2d, column, and row communicators." alt="" coords="486,68,633,107"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="474,381,645,420"/>
<area shape="rect"  href="namespacefldmgerclass.html#a028236bf0d8419b6f75a7fb28eb7226b" title="exchange grid information between neighboring guard cell to calculate E from phi." alt="" coords="245,96,418,135"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="479,256,640,295"/>
<area shape="rect"  href="namespacefldmgerclass.html#a490fceb1792fb1664488b1394dcff5f0" title="exchange the information for interpolation from neighboring guard cells." alt="" coords="251,159,413,197"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="468,444,651,483"/>
<area shape="rect"  href="namespacebeambunchclass.html#a023a12f9279f0764fc57deda1bcb852f" title="scatter grid quantity onto particles using linear map." alt="" coords="244,324,420,363"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="699,232,838,257"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a550cb1b5c94a9e168c3e0108bb8a6d5b" title="get 2D, column, and row communicators." alt="" coords="480,131,639,169"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="474,319,644,357"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_icgraph.png" border="0" usemap="#namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_icgraph" id="namespacebeambunchclass_a02f7f46438747a0fb811de64b1ed95aa_icgraph">
<area shape="rect"  title=" " alt="" coords="286,5,476,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a398a8735bfae34f0d7a9337c8e5ec621"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a398a8735bfae34f0d7a9337c8e5ec621">&#9670;&nbsp;</a></span>kick2_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::kick2_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>temppotent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom), intent(in)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (pgrid2d), intent(in)&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Flagbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>flagerr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Here, all indices of potential are local to processor. Advance the particles in the velocity space using the force from the external field and the self space charge force interpolated from the grid to particles. (Lorentz force) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a398a8735bfae34f0d7a9337c8e5ec621_cgraph.png" border="0" usemap="#namespacebeambunchclass_a398a8735bfae34f0d7a9337c8e5ec621_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a398a8735bfae34f0d7a9337c8e5ec621_cgraph" id="namespacebeambunchclass_a398a8735bfae34f0d7a9337c8e5ec621_cgraph">
<area shape="rect"  title="Here, all indices of potential are local to processor. Advance the particles in the velocity space us..." alt="" coords="5,237,165,276"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="466,285,606,324"/>
<area shape="rect"  href="namespacepgrid2dclass.html#ac088657db5b1deb05bb1ec732579ba53" title="get the total number of PEs, PEs in column and row communicators." alt="" coords="463,35,609,73"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a559d4550356f88440ae55fceda480de2" title="get my rank position in 2d, column, and row communicators." alt="" coords="462,97,609,136"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="450,536,621,575"/>
<area shape="rect"  href="namespacefldmgerclass.html#a028236bf0d8419b6f75a7fb28eb7226b" title="exchange grid information between neighboring guard cell to calculate E from phi." alt="" coords="218,117,391,156"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="455,223,616,261"/>
<area shape="rect"  href="namespacefldmgerclass.html#a490fceb1792fb1664488b1394dcff5f0" title="exchange the information for interpolation from neighboring guard cells." alt="" coords="223,180,385,219"/>
<area shape="rect"  href="namespacebeambunchclass.html#ad2054e6e5714a86db0112c5eb3978abb" title=" " alt="" coords="216,408,392,447"/>
<area shape="rect"  href="namespacebeambunchclass.html#a8a96c99996275cf03ceec41dc011695e" title="scatter grid quantity onto particles. only external fields are included" alt="" coords="213,345,396,384"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="685,5,824,31"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a550cb1b5c94a9e168c3e0108bb8a6d5b" title="get 2D, column, and row communicators." alt="" coords="456,160,615,199"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="450,473,621,512"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="444,411,627,449"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="463,348,608,387"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="675,229,834,268"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="684,292,824,331"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="688,355,820,380"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="695,404,814,443"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="691,467,818,492"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="691,516,817,541"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="684,565,825,604"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="696,628,813,667"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="688,691,821,716"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="691,740,818,779"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="692,55,816,93"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="682,117,827,156"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="685,180,824,205"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="882,229,1085,268"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="903,117,1064,156"/>
</map>
</div>

</div>
</div>
<a id="a530cca8371b8decda64389ce29d10bcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530cca8371b8decda64389ce29d10bcd">&#9670;&nbsp;</a></span>kick2wake_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::kick2wake_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>inn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_cgraph.png" border="0" usemap="#namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_cgraph" id="namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_cgraph">
<area shape="rect"  title=" " alt="" coords="5,268,196,307"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="521,285,660,324"/>
<area shape="rect"  href="namespacepgrid2dclass.html#ac088657db5b1deb05bb1ec732579ba53" title="get the total number of PEs, PEs in column and row communicators." alt="" coords="518,35,663,73"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a559d4550356f88440ae55fceda480de2" title="get my rank position in 2d, column, and row communicators." alt="" coords="517,97,664,136"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="505,473,676,512"/>
<area shape="rect"  href="namespacefldmgerclass.html#a028236bf0d8419b6f75a7fb28eb7226b" title="exchange grid information between neighboring guard cell to calculate E from phi." alt="" coords="261,119,434,157"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="510,223,671,261"/>
<area shape="rect"  href="namespacefldmgerclass.html#a490fceb1792fb1664488b1394dcff5f0" title="exchange the information for interpolation from neighboring guard cells." alt="" coords="266,181,428,220"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="499,536,682,575"/>
<area shape="rect"  href="namespacebeambunchclass.html#aa17d706a08d23a054bf547514e796e6a" title=" " alt="" coords="244,411,451,449"/>
<area shape="rect"  href="namespacebeambunchclass.html#a8a96c99996275cf03ceec41dc011695e" title="scatter grid quantity onto particles. only external fields are included" alt="" coords="255,296,439,335"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="740,5,879,31"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a550cb1b5c94a9e168c3e0108bb8a6d5b" title="get 2D, column, and row communicators." alt="" coords="511,160,670,199"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="505,411,676,449"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="518,348,663,387"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="730,229,888,268"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="739,292,879,331"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="743,355,875,380"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="750,404,869,443"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="745,467,873,492"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="746,516,872,541"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="738,565,880,604"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="751,628,868,667"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="742,691,876,716"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="745,740,873,779"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="747,55,871,93"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="737,117,882,156"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="740,180,879,205"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="936,229,1140,268"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="958,117,1119,156"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_icgraph.png" border="0" usemap="#namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_icgraph" id="namespacebeambunchclass_a530cca8371b8decda64389ce29d10bcd_icgraph">
<area shape="rect"  title=" " alt="" coords="286,5,476,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a119b1d68c4a2a790014a9408c2db1575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a119b1d68c4a2a790014a9408c2db1575">&#9670;&nbsp;</a></span>kickt_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::kickt_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>temppotent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom), intent(in)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (pgrid2d), intent(in)&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Flagbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>flagerr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a119b1d68c4a2a790014a9408c2db1575_cgraph.png" border="0" usemap="#namespacebeambunchclass_a119b1d68c4a2a790014a9408c2db1575_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a119b1d68c4a2a790014a9408c2db1575_cgraph" id="namespacebeambunchclass_a119b1d68c4a2a790014a9408c2db1575_cgraph">
<area shape="rect"  title=" " alt="" coords="5,237,161,276"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="458,285,598,324"/>
<area shape="rect"  href="namespacepgrid2dclass.html#ac088657db5b1deb05bb1ec732579ba53" title="get the total number of PEs, PEs in column and row communicators." alt="" coords="455,35,601,73"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a559d4550356f88440ae55fceda480de2" title="get my rank position in 2d, column, and row communicators." alt="" coords="455,97,602,136"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="443,536,614,575"/>
<area shape="rect"  href="namespacefldmgerclass.html#a028236bf0d8419b6f75a7fb28eb7226b" title="exchange grid information between neighboring guard cell to calculate E from phi." alt="" coords="212,117,385,156"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="448,223,608,261"/>
<area shape="rect"  href="namespacefldmgerclass.html#a490fceb1792fb1664488b1394dcff5f0" title="exchange the information for interpolation from neighboring guard cells." alt="" coords="218,180,380,219"/>
<area shape="rect"  href="namespacebeambunchclass.html#a3da6bfdf683e278c6005fddbceac16db" title="Here, the update of the momentum is in the rotated coordinates since the boost direction is not along..." alt="" coords="213,408,385,447"/>
<area shape="rect"  href="namespacebeambunchclass.html#a80dd0ce0010992cda1f2ba4d873371e0" title="Here, the update of the momentum is in the rotated coordinates since the boost direction is not along..." alt="" coords="209,345,389,384"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="677,5,816,31"/>
<area shape="rect"  href="namespacepgrid2dclass.html#a550cb1b5c94a9e168c3e0108bb8a6d5b" title="get 2D, column, and row communicators." alt="" coords="449,160,607,199"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="443,473,613,512"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="437,411,620,449"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="456,348,600,387"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="668,229,826,268"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="677,292,817,331"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="681,355,813,380"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="687,404,806,443"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="683,467,811,492"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="684,516,810,541"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="676,565,818,604"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="688,628,805,667"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="680,691,813,716"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="683,740,811,779"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="685,55,809,93"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="674,117,819,156"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="677,180,816,205"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="874,229,1078,268"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="896,117,1056,156"/>
</map>
</div>

</div>
</div>
<a id="a618f97b46c83d8ca29a7cb05345d655e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618f97b46c83d8ca29a7cb05345d655e">&#9670;&nbsp;</a></span>lostcount_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::lostcount_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nplc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nptot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>xrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>yrad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket yet. </p>

</div>
</div>
<a id="a54a4d80405bb8fbde341ea9e46a224e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a4d80405bb8fbde341ea9e46a224e4">&#9670;&nbsp;</a></span>lostcountxy_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::lostcountxy_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nplc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>nptot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>y2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket yet. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a54a4d80405bb8fbde341ea9e46a224e4_icgraph.png" border="0" usemap="#namespacebeambunchclass_a54a4d80405bb8fbde341ea9e46a224e4_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a54a4d80405bb8fbde341ea9e46a224e4_icgraph" id="namespacebeambunchclass_a54a4d80405bb8fbde341ea9e46a224e4_icgraph">
<area shape="rect"  title="counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket ..." alt="" coords="286,5,481,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a3b4334f47908375d6a6dc12f1509397c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4334f47908375d6a6dc12f1509397c">&#9670;&nbsp;</a></span>rotback_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::rotback_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6)&#160;</td>
          <td class="paramname"><em>ptref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a05e93a990ca0c8071c035d078ffb7bb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e93a990ca0c8071c035d078ffb7bb0">&#9670;&nbsp;</a></span>rotto_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::rotto_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6)&#160;</td>
          <td class="paramname"><em>ptref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6), intent(out)&#160;</td>
          <td class="paramname"><em>ptrange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rotate to the particle coordinates to local beam coordinate of "ptref". Here, the local "z" direction has been enlarged by "gamma" for the space-charge calculation. Here, "ptref" coordinate has a rotation "theta" in x-z plane with respect to the orginal coordinate. </p>

</div>
</div>
<a id="a023a12f9279f0764fc57deda1bcb852f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a023a12f9279f0764fc57deda1bcb852f">&#9670;&nbsp;</a></span>scatter1_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scatter1_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (innx,inny,innz), intent(in)&#160;</td>
          <td class="paramname"><em>exg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eyg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ezg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>gam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>curr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>mass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scatter grid quantity onto particles using linear map. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_cgraph.png" border="0" usemap="#namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_cgraph" id="namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_cgraph">
<area shape="rect"  title="scatter grid quantity onto particles using linear map." alt="" coords="5,131,182,169"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="251,5,391,44"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="235,68,407,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="236,131,406,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="230,193,412,232"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="241,256,401,295"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="460,137,600,163"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_icgraph.png" border="0" usemap="#namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_icgraph" id="namespacebeambunchclass_a023a12f9279f0764fc57deda1bcb852f_icgraph">
<area shape="rect"  title="scatter grid quantity onto particles using linear map." alt="" coords="524,37,700,76"/>
<area shape="rect"  href="namespacebeambunchclass.html#abf23fdc1e8ca69fe7fe8f2995fbc1bcc" title="Here, all indices of potential are local to processor. Advance the particles in the velocity space us..." alt="" coords="301,5,460,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a02f7f46438747a0fb811de64b1ed95aa" title=" " alt="" coords="286,68,476,107"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,68,238,107"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,75,56,100"/>
</map>
</div>

</div>
</div>
<a id="a8a96c99996275cf03ceec41dc011695e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a96c99996275cf03ceec41dc011695e">&#9670;&nbsp;</a></span>scatter20_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scatter20_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>gam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>chge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scatter grid quantity onto particles. only external fields are included </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_cgraph.png" border="0" usemap="#namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_cgraph" id="namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_cgraph">
<area shape="rect"  title="scatter grid quantity onto particles. only external fields are included" alt="" coords="5,68,189,107"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="247,5,387,44"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="245,369,389,408"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="237,68,398,107"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="455,12,594,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="446,61,604,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="455,124,595,163"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="459,187,591,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="465,236,584,275"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="461,299,589,324"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="462,348,588,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="454,397,596,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="466,460,583,499"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="458,523,591,548"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="461,572,589,611"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="463,635,587,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="452,697,597,736"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="455,760,594,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="652,61,856,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="674,697,834,736"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_icgraph.png" border="0" usemap="#namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_icgraph" id="namespacebeambunchclass_a8a96c99996275cf03ceec41dc011695e_icgraph">
<area shape="rect"  title="scatter grid quantity onto particles. only external fields are included" alt="" coords="524,37,707,76"/>
<area shape="rect"  href="namespacebeambunchclass.html#a398a8735bfae34f0d7a9337c8e5ec621" title="Here, all indices of potential are local to processor. Advance the particles in the velocity space us..." alt="" coords="301,5,460,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a530cca8371b8decda64389ce29d10bcd" title=" " alt="" coords="286,68,476,107"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,68,238,107"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,75,56,100"/>
</map>
</div>

</div>
</div>
<a id="add3fe05fd157f9a0d3f09445660f038e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add3fe05fd157f9a0d3f09445660f038e">&#9670;&nbsp;</a></span>scatter20err_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scatter20err_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>gam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>chge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>scatter grid quantity onto particles. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_add3fe05fd157f9a0d3f09445660f038e_cgraph.png" border="0" usemap="#namespacebeambunchclass_add3fe05fd157f9a0d3f09445660f038e_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_add3fe05fd157f9a0d3f09445660f038e_cgraph" id="namespacebeambunchclass_add3fe05fd157f9a0d3f09445660f038e_cgraph">
<area shape="rect"  title="scatter grid quantity onto particles." alt="" coords="5,100,205,139"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="264,5,404,44"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#aa02696ccb3d6d48bfdcb0ff3ea906fa1" title=" " alt="" coords="260,68,407,107"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#aa711cecfd3c01152cb0d88d88b645c4b" title=" " alt="" coords="253,369,414,408"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="253,131,414,169"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="480,12,619,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a41791f03ec33f0255e54ebc7b9519170" title="get external field with displacement and rotation errors." alt="" coords="462,61,637,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="479,124,619,163"/>
<area shape="rect"  href="namespacecclclass.html#a4d8386891ff89c7352f001b01d5f84b5" title="get external field with displacement and rotation errors." alt="" coords="475,187,623,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#ab81d1b262943e405eebe3bfef401bb97" title="get the external field with misalignment and rotation errors." alt="" coords="482,236,617,275"/>
<area shape="rect"  href="namespacedtlclass.html#ab866f108c00b307f9e7a55731eadafa4" title="get external field with different field and Quad displacement and rotation errors...." alt="" coords="478,299,621,324"/>
<area shape="rect"  href="namespacescclass.html#abe42c84df8190cc0443752dff296dd89" title="get external field with displacement and rotation errors." alt="" coords="478,348,620,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="479,397,620,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a8a44826fce541cba8b4f7f5573ec7c98" title="get external field with displacement and rotation errors." alt="" coords="483,460,616,499"/>
<area shape="rect"  href="namespacesolclass.html#a571ab7b6c8ce4dd9e7eaa2489b874682" title="get external field with displacement and rotation errors." alt="" coords="475,523,624,548"/>
<area shape="rect"  href="namespacedipoleclass.html#a0a75204835a2e4dd1ea67c1ee32e62fe" title="get external field with displacement and rotation errors." alt="" coords="478,572,621,611"/>
<area shape="rect"  href="namespaceemfldclass.html#ad7628b9fdaf5e839e55f71c3f8678c11" title=" " alt="" coords="479,635,620,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#ade719df1a7d0e47f6495032cb64b1450" title="get external field with displacement and rotation errors." alt="" coords="469,697,630,736"/>
<area shape="rect"  href="namespacetwsclass.html#aaf9be4899e2515903618d2a1ab1dfbbc" title="get external field with displacement and rotation errors." alt="" coords="472,760,627,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="685,61,888,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="706,697,867,736"/>
</map>
</div>

</div>
</div>
<a id="ad2054e6e5714a86db0112c5eb3978abb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2054e6e5714a86db0112c5eb3978abb">&#9670;&nbsp;</a></span>scatter2_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scatter2_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (innx,inny,innz), intent(in)&#160;</td>
          <td class="paramname"><em>exg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eyg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ezg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>gam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>curr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>chge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_cgraph.png" border="0" usemap="#namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_cgraph" id="namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_cgraph">
<area shape="rect"  title=" " alt="" coords="5,163,182,201"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="251,5,391,44"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="235,68,407,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="236,131,406,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="230,193,412,232"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="249,369,393,408"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="241,256,401,295"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="470,12,609,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="460,61,619,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="470,124,610,163"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="474,187,606,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="480,236,599,275"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="476,299,603,324"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="477,348,603,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="469,397,610,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="481,460,598,499"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="473,523,606,548"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="476,572,603,611"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="478,635,602,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="467,697,612,736"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="470,760,609,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="667,61,871,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="688,697,849,736"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_icgraph.png" border="0" usemap="#namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_icgraph" id="namespacebeambunchclass_ad2054e6e5714a86db0112c5eb3978abb_icgraph">
<area shape="rect"  title=" " alt="" coords="213,5,389,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a398a8735bfae34f0d7a9337c8e5ec621" title="Here, all indices of potential are local to processor. Advance the particles in the velocity space us..." alt="" coords="5,5,165,44"/>
</map>
</div>

</div>
</div>
<a id="a2395bc91f4fc52175d8a5cc92890bb83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2395bc91f4fc52175d8a5cc92890bb83">&#9670;&nbsp;</a></span>scatter2errwake_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scatter2errwake_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a2395bc91f4fc52175d8a5cc92890bb83_cgraph.png" border="0" usemap="#namespacebeambunchclass_a2395bc91f4fc52175d8a5cc92890bb83_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a2395bc91f4fc52175d8a5cc92890bb83_cgraph" id="namespacebeambunchclass_a2395bc91f4fc52175d8a5cc92890bb83_cgraph">
<area shape="rect"  title=" " alt="" coords="5,193,229,232"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="298,5,438,44"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="283,68,454,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="283,131,454,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="277,193,460,232"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#aa02696ccb3d6d48bfdcb0ff3ea906fa1" title=" " alt="" coords="295,256,442,295"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#aa711cecfd3c01152cb0d88d88b645c4b" title=" " alt="" coords="288,389,449,428"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="288,319,449,357"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="526,12,665,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a41791f03ec33f0255e54ebc7b9519170" title="get external field with displacement and rotation errors." alt="" coords="508,61,683,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="525,124,665,163"/>
<area shape="rect"  href="namespacecclclass.html#a4d8386891ff89c7352f001b01d5f84b5" title="get external field with displacement and rotation errors." alt="" coords="521,187,669,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#ab81d1b262943e405eebe3bfef401bb97" title="get the external field with misalignment and rotation errors." alt="" coords="528,236,663,275"/>
<area shape="rect"  href="namespacedtlclass.html#ab866f108c00b307f9e7a55731eadafa4" title="get external field with different field and Quad displacement and rotation errors...." alt="" coords="523,299,667,324"/>
<area shape="rect"  href="namespacescclass.html#abe42c84df8190cc0443752dff296dd89" title="get external field with displacement and rotation errors." alt="" coords="524,348,666,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="525,397,666,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a8a44826fce541cba8b4f7f5573ec7c98" title="get external field with displacement and rotation errors." alt="" coords="529,460,662,499"/>
<area shape="rect"  href="namespacesolclass.html#a571ab7b6c8ce4dd9e7eaa2489b874682" title="get external field with displacement and rotation errors." alt="" coords="520,523,670,548"/>
<area shape="rect"  href="namespacedipoleclass.html#a0a75204835a2e4dd1ea67c1ee32e62fe" title="get external field with displacement and rotation errors." alt="" coords="523,572,667,611"/>
<area shape="rect"  href="namespaceemfldclass.html#ad7628b9fdaf5e839e55f71c3f8678c11" title=" " alt="" coords="525,635,666,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#ade719df1a7d0e47f6495032cb64b1450" title="get external field with displacement and rotation errors." alt="" coords="515,697,676,736"/>
<area shape="rect"  href="namespacetwsclass.html#aaf9be4899e2515903618d2a1ab1dfbbc" title="get external field with displacement and rotation errors." alt="" coords="518,760,673,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="731,61,934,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="752,697,913,736"/>
</map>
</div>

</div>
</div>
<a id="aa17d706a08d23a054bf547514e796e6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa17d706a08d23a054bf547514e796e6a">&#9670;&nbsp;</a></span>scatter2wake_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scatter2wake_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (innx,inny,innz), intent(in)&#160;</td>
          <td class="paramname"><em>exg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eyg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ezg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (compdom)&#160;</td>
          <td class="paramname"><em>ptsgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>myidy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(inout)&#160;</td>
          <td class="paramname"><em>gam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>curr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>chge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_cgraph.png" border="0" usemap="#namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_cgraph" id="namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_cgraph">
<area shape="rect"  title=" " alt="" coords="5,163,213,201"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="282,5,422,44"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="267,68,438,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="267,131,437,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="261,193,444,232"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="280,369,424,408"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="272,256,432,295"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="501,12,640,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="492,61,650,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="501,124,641,163"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="505,187,637,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="511,236,630,275"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="507,299,634,324"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="508,348,634,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="500,397,641,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="512,460,629,499"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="504,523,637,548"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="507,572,634,611"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="509,635,633,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="498,697,643,736"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="501,760,640,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="698,61,902,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="720,697,880,736"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_icgraph.png" border="0" usemap="#namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_icgraph" id="namespacebeambunchclass_aa17d706a08d23a054bf547514e796e6a_icgraph">
<area shape="rect"  title=" " alt="" coords="524,5,731,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a530cca8371b8decda64389ce29d10bcd" title=" " alt="" coords="286,5,476,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a80dd0ce0010992cda1f2ba4d873371e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80dd0ce0010992cda1f2ba4d873371e0">&#9670;&nbsp;</a></span>scattert0_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scattert0_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (6), intent(inout)&#160;</td>
          <td class="paramname"><em>refpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>tg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>chge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (beamlineelem), intent(in)&#160;</td>
          <td class="paramname"><em>beamelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Here, the update of the momentum is in the rotated coordinates since the boost direction is not along z but in the x-z plane due to the bend magnet. (Without Current) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_cgraph.png" border="0" usemap="#namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_cgraph" id="namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_cgraph">
<area shape="rect"  title="Here, the update of the momentum is in the rotated coordinates since the boost direction is not along..." alt="" coords="5,68,185,107"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="244,5,384,44"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="241,369,386,408"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="233,68,394,107"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="452,12,591,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="442,61,600,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="451,124,591,163"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="455,187,587,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="462,236,581,275"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="457,299,585,324"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="458,348,584,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="450,397,592,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="463,460,580,499"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="455,523,588,548"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="457,572,585,611"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="459,635,583,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="449,697,594,736"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="452,760,591,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="648,61,852,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="670,697,831,736"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_icgraph.png" border="0" usemap="#namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_icgraph" id="namespacebeambunchclass_a80dd0ce0010992cda1f2ba4d873371e0_icgraph">
<area shape="rect"  title="Here, the update of the momentum is in the rotated coordinates since the boost direction is not along..." alt="" coords="209,5,389,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a119b1d68c4a2a790014a9408c2db1575" title=" " alt="" coords="5,5,161,44"/>
</map>
</div>

</div>
</div>
<a id="a3da6bfdf683e278c6005fddbceac16db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da6bfdf683e278c6005fddbceac16db">&#9670;&nbsp;</a></span>scattert_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::scattert_beambunch </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>inny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (9,innp), intent(inout)&#160;</td>
          <td class="paramname"><em>rays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (6), intent(inout)&#160;</td>
          <td class="paramname"><em>refpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension (innx,inny,innz), intent(in)&#160;</td>
          <td class="paramname"><em>exg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Here, the update of the momentum is in the rotated coordinates since the boost direction is not along z but in the x-z plane ue to the bend magnet. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_cgraph.png" border="0" usemap="#namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_cgraph" alt=""/></div>
<map name="namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_cgraph" id="namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_cgraph">
<area shape="rect"  title="Here, the update of the momentum is in the rotated coordinates since the boost direction is not along..." alt="" coords="5,163,178,201"/>
<area shape="rect"  href="namespacetimerclass.html#afb272bcdcff72d225c2df5862630025c" title=" " alt="" coords="247,5,387,44"/>
<area shape="rect"  href="namespacecompdomclass.html#a460a22916802ee9041aa66d1922cb812" title=" " alt="" coords="232,68,403,107"/>
<area shape="rect"  href="namespacecompdomclass.html#acba710aa1017492e05a537273742cc16" title=" " alt="" coords="232,131,402,169"/>
<area shape="rect"  href="namespacecompdomclass.html#a7c7c1450a459bb1753ef8230ab0d7651" title=" " alt="" coords="226,193,409,232"/>
<area shape="rect"  href="namespacebeamlineelemclass.html#a21fd373bab34a4c18c8bcf5b00816c0c" title=" " alt="" coords="245,369,389,408"/>
<area shape="rect"  href="namespacetimerclass.html#a3378d323d442f85aff95ab73cd13376d" title=" " alt="" coords="237,256,398,295"/>
<area shape="rect"  href="namespacempistub.html#a2456432a60801629e19273ebe4114bc9" title="mpi timing" alt="" coords="466,12,606,37"/>
<area shape="rect"  href="namespacequadrupoleclass.html#a1d1bf0b4ea88a1cd0c0832a178fc80e5" title="get external field without displacement and rotation errors." alt="" coords="457,61,615,100"/>
<area shape="rect"  href="namespacedrifttubeclass.html#aa903101ae6943402917a2f29a8aa67d3" title=" " alt="" coords="466,124,606,163"/>
<area shape="rect"  href="namespacecclclass.html#a6c8d8825e6d50c30ba91c90892619a5b" title="get external field without displacement and rotation errors." alt="" coords="470,187,602,212"/>
<area shape="rect"  href="namespaceccdtlclass.html#a62eb43f6a732d52951d468e91a2312cb" title="get the external field without misalignment and rotation errors." alt="" coords="476,236,596,275"/>
<area shape="rect"  href="namespacedtlclass.html#a9e97d93c8f7ec49afee134e3ffd3f900" title="get external field without displacement and rotation errors." alt="" coords="472,299,600,324"/>
<area shape="rect"  href="namespacescclass.html#a5af81e94b531e8d02789525f1f4438ac" title="get external field without displacement and rotation errors" alt="" coords="473,348,599,373"/>
<area shape="rect"  href="namespaceconstfocclass.html#a34425bf98b4a4cff016108f25a629dff" title=" " alt="" coords="465,397,607,436"/>
<area shape="rect"  href="namespacesolrfclass.html#a394f9bb9d3b50c8652a704f3c5af16ef" title="get external field without displacement and rotation errors." alt="" coords="478,460,594,499"/>
<area shape="rect"  href="namespacesolclass.html#a7a865f7ab4470f9bff328ed98aacd7c8" title="get external field without displacement and rotation errors and with fringe field of Solenoid...." alt="" coords="469,523,603,548"/>
<area shape="rect"  href="namespacedipoleclass.html#ac8c755e07904e113f223ee5ef029ac93" title="get external field without displacement and rotation errors." alt="" coords="472,572,600,611"/>
<area shape="rect"  href="namespaceemfldclass.html#aa0023b4b2c7a17c75becc20eeb9be23c" title=" " alt="" coords="474,635,598,673"/>
<area shape="rect"  href="namespacemultipoleclass.html#af4fb9d3cfd9db2d92930fcda605fbe26" title="get external field without displacement and rotation errors." alt="" coords="463,697,609,736"/>
<area shape="rect"  href="namespacetwsclass.html#a30d73a1ffc1ce8ce728e8fdf7caa6002" title="get external field without displacement and rotation errors." alt="" coords="466,760,606,785"/>
<area shape="rect"  href="namespacequadrupoleclass.html#ab1abe8916ad3dace3e5d1373da4688ac" title=" " alt="" coords="663,61,867,100"/>
<area shape="rect"  href="namespacemultipoleclass.html#a8712b7622d8ed7c0e71cdc18204dcf46" title="interpolate the field from the SC rf cavity onto bunch location." alt="" coords="685,697,845,736"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_icgraph.png" border="0" usemap="#namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_icgraph" id="namespacebeambunchclass_a3da6bfdf683e278c6005fddbceac16db_icgraph">
<area shape="rect"  title="Here, the update of the momentum is in the rotated coordinates since the boost direction is not along..." alt="" coords="209,5,381,44"/>
<area shape="rect"  href="namespacebeambunchclass.html#a119b1d68c4a2a790014a9408c2db1575" title=" " alt="" coords="5,5,161,44"/>
</map>
</div>

</div>
</div>
<a id="af1b14b706bd1283ff6c5a7cec4b06c48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1b14b706bd1283ff6c5a7cec4b06c48">&#9670;&nbsp;</a></span>setnpt_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::setnpt_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>innpt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set local # of particles. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebeambunchclass_af1b14b706bd1283ff6c5a7cec4b06c48_icgraph.png" border="0" usemap="#namespacebeambunchclass_af1b14b706bd1283ff6c5a7cec4b06c48_icgraph" alt=""/></div>
<map name="namespacebeambunchclass_af1b14b706bd1283ff6c5a7cec4b06c48_icgraph" id="namespacebeambunchclass_af1b14b706bd1283ff6c5a7cec4b06c48_icgraph">
<area shape="rect"  title="set local # of particles." alt="" coords="286,5,451,44"/>
<area shape="rect"  href="namespaceaccsimulatorclass.html#acbe26eeaf1cb4076384b90e1016785f0" title="Run beam dynamics simulation through accelerator." alt="" coords="104,5,238,44"/>
<area shape="rect"  href="main_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="v.1.0" alt="" coords="5,12,56,37"/>
</map>
</div>

</div>
</div>
<a id="a2cf9a1a04b69a4b2509d80522112a3bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cf9a1a04b69a4b2509d80522112a3bd">&#9670;&nbsp;</a></span>setpts_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::setpts_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>inparticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nptsin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a89d32b2a56cd1eb84867e95897af307a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d32b2a56cd1eb84867e95897af307a">&#9670;&nbsp;</a></span>transfback_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::transfback_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6)&#160;</td>
          <td class="paramname"><em>ptref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aef2d76ba15a23896de0838b2001d72b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef2d76ba15a23896de0838b2001d72b1">&#9670;&nbsp;</a></span>transfto_beambunch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine beambunchclass::transfto_beambunch </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunch</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(6)&#160;</td>
          <td class="paramname"><em>ptref</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transform the particle coordinates to local coordinate of "ptref". Here, "ptref" coordinate has a rotation "theta" in y-z plane with respect to the orginal coordinate. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
