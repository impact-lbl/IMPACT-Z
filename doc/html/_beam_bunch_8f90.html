<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IMPACT Z: src/Appl/BeamBunch.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IMPACT Z
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b73e301a063c278e244d2e684b120e12.html">Appl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">BeamBunch.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:structbeambunchclass_1_1beambunch"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#structbeambunchclass_1_1beambunch">beambunchclass::beambunch</a></td></tr>
<tr class="separator:structbeambunchclass_1_1beambunch"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacebeambunchclass_1_1map1__beambunch.html">beambunchclass::map1_beambunch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacebeambunchclass_1_1map2__beambunch.html">beambunchclass::map2_beambunch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacebeambunchclass"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html">beambunchclass</a></td></tr>
<tr class="memdesc:namespacebeambunchclass"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class defines the charged particle beam bunch information in the accelerator. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1605e527eb41043dc5962da1e3bb5159"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a1605e527eb41043dc5962da1e3bb5159">beambunchclass::construct_beambunch</a> (this, incurr, inkin, inmass, incharge</td></tr>
<tr class="separator:a1605e527eb41043dc5962da1e3bb5159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea8cfefa2f70ade95202cc40f015f7bf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aea8cfefa2f70ade95202cc40f015f7bf">beambunchclass::geomerrl_beambunch</a> (this, beamln)</td></tr>
<tr class="memdesc:aea8cfefa2f70ade95202cc40f015f7bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">shift and rotate the beam at the leading edge of the element  <a href="namespacebeambunchclass.html#aea8cfefa2f70ade95202cc40f015f7bf">More...</a><br /></td></tr>
<tr class="separator:aea8cfefa2f70ade95202cc40f015f7bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f6f9e95d5786dab15c1b73f305e349"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ab2f6f9e95d5786dab15c1b73f305e349">beambunchclass::geomerrt_beambunch</a> (this, beamln)</td></tr>
<tr class="memdesc:ab2f6f9e95d5786dab15c1b73f305e349"><td class="mdescLeft">&#160;</td><td class="mdescRight">shift and rotate the beam at the tail edge of the element  <a href="namespacebeambunchclass.html#ab2f6f9e95d5786dab15c1b73f305e349">More...</a><br /></td></tr>
<tr class="separator:ab2f6f9e95d5786dab15c1b73f305e349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be2b49f0fef567493258758c44fffd6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3be2b49f0fef567493258758c44fffd6">beambunchclass::drift1org_beambunch</a> (this, beamln, z, tau)</td></tr>
<tr class="memdesc:a3be2b49f0fef567493258758c44fffd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift beam half step using linear map for external field.  <a href="namespacebeambunchclass.html#a3be2b49f0fef567493258758c44fffd6">More...</a><br /></td></tr>
<tr class="separator:a3be2b49f0fef567493258758c44fffd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212c0d38a812d95f238d7da7f29ac17c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a212c0d38a812d95f238d7da7f29ac17c">beambunchclass::drift1_beambunch</a> (this, beamln, z, tau, bitype, nseg, nst, ih</td></tr>
<tr class="memdesc:a212c0d38a812d95f238d7da7f29ac17c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drift beam half step using linear map for external field.  <a href="namespacebeambunchclass.html#a212c0d38a812d95f238d7da7f29ac17c">More...</a><br /></td></tr>
<tr class="separator:a212c0d38a812d95f238d7da7f29ac17c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e3aecf1a2cf3d54950c09c603c2f11c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a6e3aecf1a2cf3d54950c09c603c2f11c">beambunchclass::drift2_beambunch</a> (this, z, tau)</td></tr>
<tr class="memdesc:a6e3aecf1a2cf3d54950c09c603c2f11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">drift half step using nonlinear Lorentz integrator  <a href="namespacebeambunchclass.html#a6e3aecf1a2cf3d54950c09c603c2f11c">More...</a><br /></td></tr>
<tr class="separator:a6e3aecf1a2cf3d54950c09c603c2f11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5a86fb4b3ff5b33efdfa76b1c52ce4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3f5a86fb4b3ff5b33efdfa76b1c52ce4">beambunchclass::drift2halo_beambunch</a> (this, z, tau)</td></tr>
<tr class="memdesc:a3f5a86fb4b3ff5b33efdfa76b1c52ce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">drift half step using nonlinear Lorentz integrator for halo study  <a href="namespacebeambunchclass.html#a3f5a86fb4b3ff5b33efdfa76b1c52ce4">More...</a><br /></td></tr>
<tr class="separator:a3f5a86fb4b3ff5b33efdfa76b1c52ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618f97b46c83d8ca29a7cb05345d655e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a618f97b46c83d8ca29a7cb05345d655e">beambunchclass::lostcount_beambunch</a> (this, nplc, nptot, xrad, yrad)</td></tr>
<tr class="memdesc:a618f97b46c83d8ca29a7cb05345d655e"><td class="mdescLeft">&#160;</td><td class="mdescRight">counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket yet.  <a href="namespacebeambunchclass.html#a618f97b46c83d8ca29a7cb05345d655e">More...</a><br /></td></tr>
<tr class="separator:a618f97b46c83d8ca29a7cb05345d655e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a4d80405bb8fbde341ea9e46a224e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a54a4d80405bb8fbde341ea9e46a224e4">beambunchclass::lostcountxy_beambunch</a> (this, nplc, nptot, x1, x2, y1, y2)</td></tr>
<tr class="memdesc:a54a4d80405bb8fbde341ea9e46a224e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">counter the particles get lost outside the xrad and yrad. we have not put the lost through rf bucket yet.  <a href="namespacebeambunchclass.html#a54a4d80405bb8fbde341ea9e46a224e4">More...</a><br /></td></tr>
<tr class="separator:a54a4d80405bb8fbde341ea9e46a224e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b1c15c02703f7339b67283bc9816bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ac5b1c15c02703f7339b67283bc9816bd">beambunchclass::chgupdate_beambunch</a> (this, nchge, idchgold, qmcclist)</td></tr>
<tr class="memdesc:ac5b1c15c02703f7339b67283bc9816bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">update the total current fraction of each charge state update total # of ptcl for each charge state  <a href="namespacebeambunchclass.html#ac5b1c15c02703f7339b67283bc9816bd">More...</a><br /></td></tr>
<tr class="separator:ac5b1c15c02703f7339b67283bc9816bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a030c80c97cd3523478e56fdaff0e7560"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a030c80c97cd3523478e56fdaff0e7560">beambunchclass::convforth0th_beambunch</a> (this)</td></tr>
<tr class="memdesc:a030c80c97cd3523478e56fdaff0e7560"><td class="mdescLeft">&#160;</td><td class="mdescRight">0th order algorithm to transfer from z to t frame.  <a href="namespacebeambunchclass.html#a030c80c97cd3523478e56fdaff0e7560">More...</a><br /></td></tr>
<tr class="separator:a030c80c97cd3523478e56fdaff0e7560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35f6511340579ba6bb5f07bebf6d09d5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a35f6511340579ba6bb5f07bebf6d09d5">beambunchclass::convforth1st_beambunch</a> (this)</td></tr>
<tr class="memdesc:a35f6511340579ba6bb5f07bebf6d09d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear(1st order) algorithm to transfer from z to t frame.  <a href="namespacebeambunchclass.html#a35f6511340579ba6bb5f07bebf6d09d5">More...</a><br /></td></tr>
<tr class="separator:a35f6511340579ba6bb5f07bebf6d09d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12625a90fb4a096ff15ba55f655b148"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ad12625a90fb4a096ff15ba55f655b148">beambunchclass::convback0th_beambunch</a> (this)</td></tr>
<tr class="memdesc:ad12625a90fb4a096ff15ba55f655b148"><td class="mdescLeft">&#160;</td><td class="mdescRight">0th order algorithm to transfer from t to z frame.  <a href="namespacebeambunchclass.html#ad12625a90fb4a096ff15ba55f655b148">More...</a><br /></td></tr>
<tr class="separator:ad12625a90fb4a096ff15ba55f655b148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704068cca17e98c6568c1e6056d1c4d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a704068cca17e98c6568c1e6056d1c4d6">beambunchclass::convback1st_beambunch</a> (this)</td></tr>
<tr class="memdesc:a704068cca17e98c6568c1e6056d1c4d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear algorithm to transfer from t to z frame.  <a href="namespacebeambunchclass.html#a704068cca17e98c6568c1e6056d1c4d6">More...</a><br /></td></tr>
<tr class="separator:a704068cca17e98c6568c1e6056d1c4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374fdc0e530a8835113fcd674283a150"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a374fdc0e530a8835113fcd674283a150">beambunchclass::conv0thold_beambunch</a> (this, tau, rad, nplc, nptot)</td></tr>
<tr class="memdesc:a374fdc0e530a8835113fcd674283a150"><td class="mdescLeft">&#160;</td><td class="mdescRight">from z to t beam frame 0th order approximation.  <a href="namespacebeambunchclass.html#a374fdc0e530a8835113fcd674283a150">More...</a><br /></td></tr>
<tr class="separator:a374fdc0e530a8835113fcd674283a150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad456951b863b3dfab6eb7fa018e17230"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ad456951b863b3dfab6eb7fa018e17230">beambunchclass::conv0th_beambunch</a> (this, tau, nplc, nptot, ptrange, Flagbc, perd, xrad, yrad)</td></tr>
<tr class="memdesc:ad456951b863b3dfab6eb7fa018e17230"><td class="mdescLeft">&#160;</td><td class="mdescRight">from z to t beam frame 0th order transformation.  <a href="namespacebeambunchclass.html#ad456951b863b3dfab6eb7fa018e17230">More...</a><br /></td></tr>
<tr class="separator:ad456951b863b3dfab6eb7fa018e17230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b46fd8b4c41577688761ad62175772b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a0b46fd8b4c41577688761ad62175772b">beambunchclass::conv1st_beambunch</a> (this, tau, nplc, nptot, ptrange, Flagbc, perd, xrad, yrad)</td></tr>
<tr class="memdesc:a0b46fd8b4c41577688761ad62175772b"><td class="mdescLeft">&#160;</td><td class="mdescRight">from z to t beam frame 1st order transformation.  <a href="namespacebeambunchclass.html#a0b46fd8b4c41577688761ad62175772b">More...</a><br /></td></tr>
<tr class="separator:a0b46fd8b4c41577688761ad62175772b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acacb775484bda2729c3da9adbbeffc53"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#acacb775484bda2729c3da9adbbeffc53">beambunchclass::cvbkforth1st_beambunch</a> (this)</td></tr>
<tr class="separator:acacb775484bda2729c3da9adbbeffc53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf23fdc1e8ca69fe7fe8f2995fbc1bcc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#abf23fdc1e8ca69fe7fe8f2995fbc1bcc">beambunchclass::kick1_beambunch</a> (this, tau, innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, perdlen)</td></tr>
<tr class="memdesc:abf23fdc1e8ca69fe7fe8f2995fbc1bcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, all indices of potential are local to processor. Advance the particles in the velocity space using the force from the external field and the self space charge force interpolated from the grid to particles. (linear map)  <a href="namespacebeambunchclass.html#abf23fdc1e8ca69fe7fe8f2995fbc1bcc">More...</a><br /></td></tr>
<tr class="separator:abf23fdc1e8ca69fe7fe8f2995fbc1bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a023a12f9279f0764fc57deda1bcb852f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a023a12f9279f0764fc57deda1bcb852f">beambunchclass::scatter1_beambunch</a> (innp, innx, inny, innz, rays, exg, eyg, ezg, ptsgeom, npx, npy, myidx, myidy, gam, curr, tau, mass</td></tr>
<tr class="memdesc:a023a12f9279f0764fc57deda1bcb852f"><td class="mdescLeft">&#160;</td><td class="mdescRight">scatter grid quantity onto particles using linear map.  <a href="namespacebeambunchclass.html#a023a12f9279f0764fc57deda1bcb852f">More...</a><br /></td></tr>
<tr class="separator:a023a12f9279f0764fc57deda1bcb852f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398a8735bfae34f0d7a9337c8e5ec621"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a398a8735bfae34f0d7a9337c8e5ec621">beambunchclass::kick2_beambunch</a> (this, beamelem, z, tau, innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, flagerr)</td></tr>
<tr class="memdesc:a398a8735bfae34f0d7a9337c8e5ec621"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, all indices of potential are local to processor. Advance the particles in the velocity space using the force from the external field and the self space charge force interpolated from the grid to particles. (Lorentz force)  <a href="namespacebeambunchclass.html#a398a8735bfae34f0d7a9337c8e5ec621">More...</a><br /></td></tr>
<tr class="separator:a398a8735bfae34f0d7a9337c8e5ec621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2054e6e5714a86db0112c5eb3978abb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#ad2054e6e5714a86db0112c5eb3978abb">beambunchclass::scatter2_beambunch</a> (innp, innx, inny, innz, rays, exg, eyg, ezg, ptsgeom, npx, npy, myidx, myidy, tg, gam, curr, chge, mass, tau, z,</td></tr>
<tr class="separator:ad2054e6e5714a86db0112c5eb3978abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a96c99996275cf03ceec41dc011695e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a8a96c99996275cf03ceec41dc011695e">beambunchclass::scatter20_beambunch</a> (innp, rays, tg, gam, chge, mass, tau, z, beamelem)</td></tr>
<tr class="memdesc:a8a96c99996275cf03ceec41dc011695e"><td class="mdescLeft">&#160;</td><td class="mdescRight">scatter grid quantity onto particles. only external fields are included  <a href="namespacebeambunchclass.html#a8a96c99996275cf03ceec41dc011695e">More...</a><br /></td></tr>
<tr class="separator:a8a96c99996275cf03ceec41dc011695e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3fe05fd157f9a0d3f09445660f038e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#add3fe05fd157f9a0d3f09445660f038e">beambunchclass::scatter20err_beambunch</a> (innp, rays, tg, gam, chge, mass, tau, z, beamelem)</td></tr>
<tr class="memdesc:add3fe05fd157f9a0d3f09445660f038e"><td class="mdescLeft">&#160;</td><td class="mdescRight">scatter grid quantity onto particles.  <a href="namespacebeambunchclass.html#add3fe05fd157f9a0d3f09445660f038e">More...</a><br /></td></tr>
<tr class="separator:add3fe05fd157f9a0d3f09445660f038e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91563d467d36ccca8231ee2c62483246"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a91563d467d36ccca8231ee2c62483246">beambunchclass::charge_beambunch</a> (this, innp, innx, inny, innz, ptsgeom, grid, chgdens, Flagbc, perdlen)</td></tr>
<tr class="memdesc:a91563d467d36ccca8231ee2c62483246"><td class="mdescLeft">&#160;</td><td class="mdescRight">All indices here are local to the processor. find charge density on grid from particles.  <a href="namespacebeambunchclass.html#a91563d467d36ccca8231ee2c62483246">More...</a><br /></td></tr>
<tr class="separator:a91563d467d36ccca8231ee2c62483246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf9a1a04b69a4b2509d80522112a3bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a2cf9a1a04b69a4b2509d80522112a3bd">beambunchclass::setpts_beambunch</a> (this, inparticles, nptsin)</td></tr>
<tr class="separator:a2cf9a1a04b69a4b2509d80522112a3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b14b706bd1283ff6c5a7cec4b06c48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#af1b14b706bd1283ff6c5a7cec4b06c48">beambunchclass::setnpt_beambunch</a> (this, innpt)</td></tr>
<tr class="memdesc:af1b14b706bd1283ff6c5a7cec4b06c48"><td class="mdescLeft">&#160;</td><td class="mdescRight">set local # of particles.  <a href="namespacebeambunchclass.html#af1b14b706bd1283ff6c5a7cec4b06c48">More...</a><br /></td></tr>
<tr class="separator:af1b14b706bd1283ff6c5a7cec4b06c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec332b229b76111b68db82b20ab2846e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aec332b229b76111b68db82b20ab2846e">beambunchclass::getnpt_beambunch</a> (this, outnpt)</td></tr>
<tr class="memdesc:aec332b229b76111b68db82b20ab2846e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get local # of particles.  <a href="namespacebeambunchclass.html#aec332b229b76111b68db82b20ab2846e">More...</a><br /></td></tr>
<tr class="separator:aec332b229b76111b68db82b20ab2846e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc601844eaf85727173ebd3ef6d2b256"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#abc601844eaf85727173ebd3ef6d2b256">beambunchclass::getpts_beambunch</a> (this, outparticles)</td></tr>
<tr class="separator:abc601844eaf85727173ebd3ef6d2b256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0438cba132ce3b2fdc8e053375c0097"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aa0438cba132ce3b2fdc8e053375c0097">beambunchclass::deposit_beambunch</a> (innp, innx, inny, innz, rays, rho, ptsgeom, npx, npy, myidx, myidy)</td></tr>
<tr class="memdesc:aa0438cba132ce3b2fdc8e053375c0097"><td class="mdescLeft">&#160;</td><td class="mdescRight">deposit particles onto grid.  <a href="namespacebeambunchclass.html#aa0438cba132ce3b2fdc8e053375c0097">More...</a><br /></td></tr>
<tr class="separator:aa0438cba132ce3b2fdc8e053375c0097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe1e4d236f209b18f75b272bf07782d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a0fe1e4d236f209b18f75b272bf07782d">beambunchclass::destruct_beambunch</a> (this)</td></tr>
<tr class="separator:a0fe1e4d236f209b18f75b272bf07782d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2d76ba15a23896de0838b2001d72b1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aef2d76ba15a23896de0838b2001d72b1">beambunchclass::transfto_beambunch</a> (this, ptref)</td></tr>
<tr class="memdesc:aef2d76ba15a23896de0838b2001d72b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">transform the particle coordinates to local coordinate of "ptref". Here, "ptref" coordinate has a rotation "theta" in y-z plane with respect to the orginal coordinate.  <a href="namespacebeambunchclass.html#aef2d76ba15a23896de0838b2001d72b1">More...</a><br /></td></tr>
<tr class="separator:aef2d76ba15a23896de0838b2001d72b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d32b2a56cd1eb84867e95897af307a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a89d32b2a56cd1eb84867e95897af307a">beambunchclass::transfback_beambunch</a> (this, ptref)</td></tr>
<tr class="separator:a89d32b2a56cd1eb84867e95897af307a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e93a990ca0c8071c035d078ffb7bb0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a05e93a990ca0c8071c035d078ffb7bb0">beambunchclass::rotto_beambunch</a> (this, ptref, ptrange)</td></tr>
<tr class="memdesc:a05e93a990ca0c8071c035d078ffb7bb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">rotate to the particle coordinates to local beam coordinate of "ptref". Here, the local "z" direction has been enlarged by "gamma" for the space-charge calculation. Here, "ptref" coordinate has a rotation "theta" in x-z plane with respect to the orginal coordinate.  <a href="namespacebeambunchclass.html#a05e93a990ca0c8071c035d078ffb7bb0">More...</a><br /></td></tr>
<tr class="separator:a05e93a990ca0c8071c035d078ffb7bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4334f47908375d6a6dc12f1509397c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3b4334f47908375d6a6dc12f1509397c">beambunchclass::rotback_beambunch</a> (this, ptref)</td></tr>
<tr class="separator:a3b4334f47908375d6a6dc12f1509397c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f485cba1b5e039b1a25b4b4bd9d81f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a82f485cba1b5e039b1a25b4b4bd9d81f">beambunchclass::convzt_beambunch</a> (this)</td></tr>
<tr class="memdesc:a82f485cba1b5e039b1a25b4b4bd9d81f"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert from z coordinates (x,px,y,py,phase,pt0-pt) to t frame coordinates (x,px,y,py,z,pz). Here, x normalized by xl, px = gamma beta_x.  <a href="namespacebeambunchclass.html#a82f485cba1b5e039b1a25b4b4bd9d81f">More...</a><br /></td></tr>
<tr class="separator:a82f485cba1b5e039b1a25b4b4bd9d81f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d14e9a28575e2d4d173669b8e0356a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a9d14e9a28575e2d4d173669b8e0356a7">beambunchclass::convtz_beambunch</a> (this, tout)</td></tr>
<tr class="memdesc:a9d14e9a28575e2d4d173669b8e0356a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear algorithm to transfer from t to z frame after bend. The Cartesian coordinate has been rotated following the exit direction of the reference particle. The exit angle of the reference particle should correspond to the bend angle.  <a href="namespacebeambunchclass.html#a9d14e9a28575e2d4d173669b8e0356a7">More...</a><br /></td></tr>
<tr class="separator:a9d14e9a28575e2d4d173669b8e0356a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8970622c75fe29b57d31607d71692976"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a8970622c75fe29b57d31607d71692976">beambunchclass::drifthalft_beambunch</a> (this, t, tau)</td></tr>
<tr class="memdesc:a8970622c75fe29b57d31607d71692976"><td class="mdescLeft">&#160;</td><td class="mdescRight">drift half step in positions. Here, x, y, z are normalized by C * Dt tau - normalized step size (by Dt). the time "t" is normalized by the scaling frequency.  <a href="namespacebeambunchclass.html#a8970622c75fe29b57d31607d71692976">More...</a><br /></td></tr>
<tr class="separator:a8970622c75fe29b57d31607d71692976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a119b1d68c4a2a790014a9408c2db1575"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a119b1d68c4a2a790014a9408c2db1575">beambunchclass::kickt_beambunch</a> (this, beamelem, z, tau, innx, inny, innz, temppotent, ptsgeom, grid, Flagbc, flagerr)</td></tr>
<tr class="separator:a119b1d68c4a2a790014a9408c2db1575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da6bfdf683e278c6005fddbceac16db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a3da6bfdf683e278c6005fddbceac16db">beambunchclass::scattert_beambunch</a> (innp, innx, inny, innz, rays, refpt, exg</td></tr>
<tr class="memdesc:a3da6bfdf683e278c6005fddbceac16db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, the update of the momentum is in the rotated coordinates since the boost direction is not along z but in the x-z plane ue to the bend magnet.  <a href="namespacebeambunchclass.html#a3da6bfdf683e278c6005fddbceac16db">More...</a><br /></td></tr>
<tr class="separator:a3da6bfdf683e278c6005fddbceac16db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80dd0ce0010992cda1f2ba4d873371e0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a80dd0ce0010992cda1f2ba4d873371e0">beambunchclass::scattert0_beambunch</a> (innp, rays, refpt, tg, chge, mass, dt, z, beamelem)</td></tr>
<tr class="memdesc:a80dd0ce0010992cda1f2ba4d873371e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here, the update of the momentum is in the rotated coordinates since the boost direction is not along z but in the x-z plane due to the bend magnet. (Without Current)  <a href="namespacebeambunchclass.html#a80dd0ce0010992cda1f2ba4d873371e0">More...</a><br /></td></tr>
<tr class="separator:a80dd0ce0010992cda1f2ba4d873371e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f7f46438747a0fb811de64b1ed95aa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a02f7f46438747a0fb811de64b1ed95aa">beambunchclass::kick1wake_beambunch</a> (this, tau, innx, inny, innz, temppoten</td></tr>
<tr class="separator:a02f7f46438747a0fb811de64b1ed95aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530cca8371b8decda64389ce29d10bcd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a530cca8371b8decda64389ce29d10bcd">beambunchclass::kick2wake_beambunch</a> (this, beamelem, z, tau, innx, inny, inn</td></tr>
<tr class="separator:a530cca8371b8decda64389ce29d10bcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17d706a08d23a054bf547514e796e6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#aa17d706a08d23a054bf547514e796e6a">beambunchclass::scatter2wake_beambunch</a> (innp, innx, inny, innz, rays, exg, eyg, ezg, ptsgeom, npx, npy, myidx, myidy, tg, gam, curr, chge, mass, tau, z,</td></tr>
<tr class="separator:aa17d706a08d23a054bf547514e796e6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2395bc91f4fc52175d8a5cc92890bb83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebeambunchclass.html#a2395bc91f4fc52175d8a5cc92890bb83">beambunchclass::scatter2errwake_beambunch</a> (innp, innx, inny, innz, rays, ex</td></tr>
<tr class="separator:a2395bc91f4fc52175d8a5cc92890bb83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Type Documentation</h2>
<a name="structbeambunchclass_1_1beambunch" id="structbeambunchclass_1_1beambunch"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structbeambunchclass_1_1beambunch">&#9670;&nbsp;</a></span>beambunchclass::beambunch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type beambunchclass::beambunch</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"></div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a555bb0dc53871a3f69755125598c8938"></a>double precision</td>
<td class="fieldname">
charge</td>
<td class="fielddoc">
beam freq, current, part. mass and charge. </td></tr>
<tr><td class="fieldtype">
<a id="a0611d8fb67f60eb1ea7a3df79c5de915"></a>double precision</td>
<td class="fieldname">
current</td>
<td class="fielddoc">
beam freq, current, part. mass and charge. </td></tr>
<tr><td class="fieldtype">
<a id="abeaad3b1ce823a9c49cab5a8b96f5ff0"></a>double precision</td>
<td class="fieldname">
mass</td>
<td class="fielddoc">
beam freq, current, part. mass and charge. </td></tr>
<tr><td class="fieldtype">
<a id="a20f5303645e1b7fa0cbfa88f81cda947"></a>integer</td>
<td class="fieldname">
npt</td>
<td class="fielddoc">
# of total global macroparticles and local particles </td></tr>
<tr><td class="fieldtype">
<a id="a71a8687235fdc19d862fb13092b714a3"></a>integer</td>
<td class="fieldname">
nptlocal</td>
<td class="fielddoc">
# of total global macroparticles and local particles </td></tr>
<tr><td class="fieldtype">
<a id="af0d19c1e3e537ade010af8554783c8d7"></a>double precision, dimension(:,:), pointer</td>
<td class="fieldname">
pts1</td>
<td class="fielddoc">
particles type one. </td></tr>
<tr><td class="fieldtype">
<a id="a973e0e4ee1b24185bac1d727d2c074f5"></a>double precision, dimension(6)</td>
<td class="fieldname">
refptcl</td>
<td class="fielddoc">
reference particle </td></tr>
</table>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
